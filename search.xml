<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>[文献阅读]</title>
      <link href="/2024/06/07/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/"/>
      <url>/2024/06/07/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/05/09/%E9%87%91%E7%BA%B3%E7%B1%B3%E5%90%88%E6%88%901/"/>
      <url>/2024/05/09/%E9%87%91%E7%BA%B3%E7%B1%B3%E5%90%88%E6%88%901/</url>
      
        <content type="html"><![CDATA[<h3 id="金纳米合成1">金纳米合成1</h3><p>试剂：l-抗坏血酸（AA：99%），十六烷基三甲基溴化铵（CTAB： 99%）</p><p>各种形状的纳米晶体的制备（种子生长法的改进）</p><p>首先，通过快速还原金盐来合成金种子：</p><p>将0.25 mL HAuCl<sub>4</sub>（10 mM）加入含有 7.5 mL CTAB（100 mM）的水溶液中，溶液变成了黄色的溶液。然后注射0.8 mL NaBH<sub>4</sub>（10 mM），溶液的颜色立即改为深棕色。然后快速混合2 min，将种子溶液在28 ℃下保存3h，分解剩余的NaBH<sub>4</sub>。将溶液用去离子水稀释（1：10）以合成较大的颗粒。</p><p>不同形状的金纳米颗粒的形成由生长溶液中CTAB和AA的浓度控制：</p><p>通常，将HAuCl<sub>4</sub>（10 mM，0.2 mL）和AA（0.95 mL）加入到CTAB（1.6 mL）的去离子水（8 mL）溶液中。采用不同浓度的CTAB（100 mM、200 mM、300 mM）和AA（5mM-800mM）合成不同形态的金纳米颗粒。例如，在生长溶液中加入CTAB（100 mM）后，分别注入50 mM、100 mM或400 mM的AA，形成立方八面体、立方体和菱形十二面体。在生长溶液中加入5 µL稀释后的Au种子，形成金纳米颗粒的各个形状。将生长溶液完全混合，不干扰15  min。所得到的纳米晶体被离心去除多余的试剂，并另外清洗和重新分散在水中。</p><h3 id="金纳米合成2">金纳米合成2</h3><p>金种子颗粒的合成：</p><p>制备了10 mL的含2.5*10<sup>4</sup> M HAuCl<sub>4</sub>和0.10 M CTAC的水溶液。同时，制作了10 mL的0.02 M <strong>冰冷</strong>的NaBH<sub>4</sub>溶液。在HAuCl<sub>4</sub>溶液中加入0.45 mLNaBH<sub>4</sub>溶液。所得到的溶液立即变成棕色，表明有了金颗粒的形成。种子溶液在30 ℃下陈化1 h。</p><p>小金纳米球体、八面体和菱形十二面体的合成:</p><p>两个小瓶分别标记为A和B，两个小瓶分别制备A生长溶液。第一，添加0.32 g CTAC表面活性剂。最终溶液中CTAC的浓度为0.10 M。根据合成金纳米晶的形态，每个小瓶中加入略微不同体积的去离子水（菱形十二面体9.545 mL，纳米晶9.605 mL，八面体9.470 mL）。然后将小瓶保存在30 ℃的水浴中。在两个小瓶中加入250 μL 0.01 M HAuCl<sub>4</sub>溶液和10 μL 0.01 M NaBr的菱形十二面体和纳米球。对于八面体，加入了5 μL的0.01 M KI，而不是NaBr。最后，分别引入150、90和220 μL 抗坏血酸用于合成菱形十二面体、纳米二面体和八面体。每个小瓶中的总溶液体积为10 mL。加入抗坏血酸后，溶液颜色变为无色，表明Au3+还原为Au+物种。接下来，将45 μL（菱形十二面体和纳米球）或55 μL（八面体）的种子溶液振荡加入到A瓶溶液中，直到溶液颜色变成浅粉红色（∼5 s）。然后将A瓶中溶液的45 μL（菱形十二面体和纳米球）或55 μL（八面体）转移到B瓶中，彻底混合∼10 s。将B瓶中溶液不干扰15 min颗粒生长，3000 rpm离心3次10 min（Hermle Z323离心机）。这些粒子被浓缩到一个1 mL的溶液中。</p><p>大金菱形十二面体、纳米球体和八面体的合成:</p><p>合成过程与上述合成过程相同。增加颗粒大小，只需要改变去离子水的体积用于9.565、9.625和9.490 mL分别菱形十二面体，纳米球，八面体和改变加入到A瓶溶液中的种子溶液的体积25 μL对于菱形十二面体和纳米二面体或35 μL对于八面体。同样的体积应转移到小瓶B。</p><h3 id="手性纳米粒子">手性纳米粒子</h3><p>立方体和八面体种子的合成按照以上方式。</p><p>在使用前，两种种子纳米颗粒分别离心两次（6708g，150s），并分散在CTAB（1mM）水溶液中。在典型的合成中，将0.8 mL 100 mM CTAB和0.2mL 10 mM HAuCl<sub>4</sub>加入3.95ml去离子水中，形成[AuBr<sub>4</sub>]−复合物。然后通过快速注射0.475 mL的100 mM AA溶液，将Au<sup>3+</sup>还原为Au<sup>+</sup>。在生长溶液中加入5 μl氨基酸或肽溶液和50 μl种子溶液，促进手性纳米颗粒的生长。</p><p>为了制备432螺旋体I：</p><p>在生长溶液中加入立方种子溶液，孵育20分钟后加入100μM半胱氨酸。</p><p>为了制备432螺旋体II：</p><p>在生长溶液中加入2mM谷胱甘肽，然后加入立方种子溶液。</p><p>为制备432个螺旋体III，在生长溶液中加入5mM谷胱甘肽，然后加入八面体种子溶液。</p><p>将生长溶液置于30°C浴中2 h，粉红色溶液逐渐变为蓝色，散射量较大。溶液离心两次（1677g，60s）去除未反应的试剂，并重新分散在1mM CTAB溶液中进行进一步表征。</p><h3 id="圆二色光谱-简称CD">圆二色光谱(简称CD)</h3><p>是应用最为广泛的测定蛋白质二级结构的方法，是研究稀溶液中蛋白质构象的一种快速、简单、较准确的方法。它可以在溶液状态下测定，较接近其生理状态。而且测定方法快速简便，对构象变化灵敏，所以它是研究<strong>蛋白质二级结构</strong>的主要手段之一，并已广泛应用于蛋白质的构象研究中。</p><p>用于推断非对称分子的构型和构象的一种旋光光谱。光学活性物质对组成<a href="https://baike.baidu.com/item/%E5%B9%B3%E9%9D%A2%E5%81%8F%E6%8C%AF%E5%85%89/0?fromModule=lemma_inlink">平面偏振光</a>的左旋和右旋圆偏振光的<a href="https://baike.baidu.com/item/%E5%90%B8%E6%94%B6%E7%B3%BB%E6%95%B0/0?fromModule=lemma_inlink">吸收系数</a>(ε)是不相等的，εL≠εR，即具有<a href="https://baike.baidu.com/item/%E5%9C%86%E4%BA%8C%E8%89%B2%E6%80%A7/0?fromModule=lemma_inlink">圆二色性</a>。如果以不同波长的<a href="https://baike.baidu.com/item/%E5%B9%B3%E9%9D%A2%E5%81%8F%E6%8C%AF%E5%85%89/0?fromModule=lemma_inlink">平面偏振光</a>的波长λ为横坐标，以吸收系数之差Δε=εL-εR为纵坐标作图，得到的<a href="https://baike.baidu.com/item/%E5%9B%BE%E8%B0%B1/0?fromModule=lemma_inlink">图谱</a>即是圆二色光谱，简称CD。如果某手性化合物在紫外可见区域有吸收，就可以得到具有特征的圆二色光谱。由于εL≠εR，透射光不再是平面偏振光，而是椭圆偏振光，摩尔椭圆度[θ]与Δε的关系为：[θ]=3300Δε。圆二色谱也可以摩尔椭圆度为纵坐标，以波长为横坐标作图。由于△ε有正值和负值之分，所以圆二色谱也有呈峰的正性圆二色谱和呈谷的负性圆二色谱。在紫外可见光区域测定圆二色谱与旋光谱，其目的是推断有机化合物的构型和构象。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/05/07/%E7%94%B5%E5%AD%90%E5%AF%86%E5%BA%A6%E5%B7%AE%E5%9B%BE/"/>
      <url>/2024/05/07/%E7%94%B5%E5%AD%90%E5%AF%86%E5%BA%A6%E5%B7%AE%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<h3 id="电子密度差图">电子密度差图</h3><p>electron density difference</p><p><a href="http://sobereva.com/113">使用Multiwfn作电子密度差图 - 思想家公社的门口：量子化学·分子模拟·二次元 (sobereva.com)</a></p><p>(2)GTF信息：这里说的GTF具体是指primitive Gaussian type function。“GTF信息”具体是指各个轨道的占据数与能量、各轨道向各个GTF的展开系数，以及各个GTF的具体定义（指数、所属中心、类型等），这需要有一定量化理论基础知识才能彻底弄明白。Multiwfn中直接基于实空间函数（即电子密度、静电势、ELF、RDG、自旋密度等各种三维函数，以及相关穴、源函数等六维函数）的分析都是基于GTF信息做的。因此，比如绘制各种实空间函数的曲线图、平面图、等值面图及差值图，做拓扑分析，做盆分析，计算拉普拉斯键级与模糊键级，计算ADCH/CHELPG/Hirshfeld等电荷，做定量分子表面分析，进行模糊原子空间分析等，都需要提供GTF信息。</p><h3 id="3-1-wfn文件">3.1 wfn文件</h3><p>wfn文件格式最早源于AIM分析程序AIMPAC，现在已经是被支持最广泛的记录GTF信息的波函数文件格式，Gaussian、ORCA、GAMESS-US、Q-Chem、NWChem等诸多程序都可以直接产生它。此格式的详细介绍看此文《高斯fch文件与wfn波函数文件的介绍及转换方法》（<a href="http://sobereva.com/55%EF%BC%89%E3%80%82%E6%B3%A8%E6%84%8F%E6%AD%A4%E6%96%87%E4%BB%B6%E4%B8%8D%E5%8C%85%E5%90%AB%E7%A9%BA%E8%BD%A8%E9%81%93%EF%BC%8C%E6%89%80%E4%BB%A5%E6%B2%A1%E6%B3%95%E5%9F%BA%E4%BA%8Ewfn%E6%96%87%E4%BB%B6%E8%80%83%E5%AF%9F%E7%A9%BA%E8%BD%A8%E9%81%93%EF%BC%8C%E4%B9%9F%E6%B2%A1%E6%B3%95%E5%9F%BA%E4%BA%8Ewfn%E6%96%87%E4%BB%B6%E7%AE%97%E4%B8%80%E4%BA%9B%E6%B6%89%E5%8F%8A%E5%88%B0%E7%A9%BA%E8%BD%A8%E9%81%93%E7%9A%84%E9%87%8F%EF%BC%8C%E6%AF%94%E5%A6%82%E8%AE%A1%E7%AE%97%E5%B1%80%E9%83%A8%E7%94%B5%E5%AD%90%E4%BA%B2%E5%92%8C%E8%83%BD%E3%80%82%E4%B8%8B%E9%9D%A2%E4%BB%8B%E7%BB%8D%E5%87%A0%E7%A7%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E9%87%8F%E5%8C%96%E7%A8%8B%E5%BA%8F%E4%BA%A7%E7%94%9Fwfn%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82">http://sobereva.com/55）。注意此文件不包含空轨道，所以没法基于wfn文件考察空轨道，也没法基于wfn文件算一些涉及到空轨道的量，比如计算局部电子亲和能。下面介绍几种常用的量化程序产生wfn文件的方法。</a></p><p>(1)用Gaussian产生wfn文件<br>在Gaussian中产生wfn文件很简单，写上out=wfn，然后末尾空一行写上输出路径就完了，比如下面是Linux下输入文件一例，在各种计算都完成后，wfn文件就会导出到/sob/poi.wfn<br># B3LYP/6-31g(d) out=wfn<br>[空行]<br>Title Card Required<br>[空行]<br>0 1<br>O         0.00000000  0.00000000  0.11472000<br>H         0.00000000  0.75403100  -0.45888100<br>H         0.00000000  -0.75403100  -0.45888100<br>[空行]<br>/sob/poi.wfn<br>[空行]<br>[空行]</p><p>对于目前的Gaussian版本，后HF或CIS/TDDFT电子激发计算时默认是产生自然轨道并把它们输出到wfn文件里的。如果你用的是MCSCF方法，还必须同时写pop=no，此时得到的wfn文件里记录的才是相应的自然轨道，否则记录的是赝正则轨道。</p><p>如果你用的是G09 C.01以前的版本，注意阅读以下文字：</p><p>对于后HF计算，如果你想让wfn文件里存的是后HF级别的自然轨道，而不是HF轨道；或者对于CIS/TDDFT计算，想让wfn文件里存的是激发态的自然轨道，而不是基态轨道，那么必须额外写上density关键词（等价于density=current），代表产生当前计算级别的波函数（以自然轨道方式描述），例如# CCSD/cc-pVTZ out=wfn density会在wfn文件里写入CCSD的自然轨道。对于G09 C.01及以后版本，就不再需要写density关键词了，因为程序只要看到out=wfn，就默认用了density关键词。</p><p>如果是基于非限制性HF波函数做的后HF计算，你想输出到wfn中的是自然自旋轨道（占据数在0~1之间，区分自旋），而不是空间自然轨道（占据数在0~2之间，不区分自旋），那么除了density关键词以外还得写上pop=NOAB才行。对于G09 C.01及之后的版本就没这个问题了。</p><p>经常有人问诸如此类问题：“给Multiwfn用的波函数文件是不是必须单点任务产生的？”、“在优化后有没有必要做单点来产生？”、“能不能用优化任务直接产生的波函数文件？”。在这里明确说一下此问题。Gaussian做单点、opt、freq、NMR、polar等任务，都可以同时产生当前计算级别的波函数文件（wfn或wfx或fch）。对于opt任务，波函数文件记录的是最终结构的波函数。显然，只要你当前波函数文件里的波函数是你要想分析的，波函数文件就可以给Multiwfn用，而不用管是什么任务产生的。比如你在B3LYP/6-31G<em>级别下优化一个体系，并且觉得这个级别的波函数的质量对于当前分析够用了，显然就可以用这个opt任务直接得到的波函数文件做分析。如果你嫌B3LYP/6-31G</em>级别略low，想让波函数分析结果质量更高，那么比如可以在优化后的结构基础上再在B3LYP/def2-TZVP下算个单点任务产生波函数文件作为Multiwfn的输入文件。</p><p>对于scan、IRC任务，如果你想把每个点的wfn文件都产生出来，可以看此文《产生Gaussian的IRC和SCAN任务每个点的波函数文件的工具》（<a href="http://sobereva.com/199%EF%BC%89%EF%BC%8C%E7%94%B1%E6%AD%A4%E5%8F%AF%E4%BB%A5%E5%81%9A%E4%B8%80%E4%BA%9B%E5%BE%88%E6%9C%89%E6%84%8F%E4%B9%89%E7%9A%84%E5%88%86%E6%9E%90%EF%BC%8C%E6%AF%94%E5%A6%82%E3%80%8A%E9%80%9A%E8%BF%87%E9%94%AE%E7%BA%A7%E6%9B%B2%E7%BA%BF%E5%92%8CELF/LOL/RDG%E7%AD%89%E5%80%BC%E9%9D%A2%E5%8A%A8%E7%94%BB%E7%A0%94%E7%A9%B6%E5%8C%96%E5%AD%A6%E5%8F%8D%E5%BA%94%E8%BF%87%E7%A8%8B%E3%80%8B%EF%BC%88http://sobereva.com/200%EF%BC%89%E3%80%81%E3%80%8A%E5%88%B6%E4%BD%9C%E5%8A%A8%E7%94%BB%E5%88%86%E6%9E%90%E7%94%B5%E5%AD%90%E7%BB%93%E6%9E%84%E7%89%B9%E5%BE%81%E3%80%8B%EF%BC%88http://sobereva.com/86%EF%BC%89%E3%80%82">http://sobereva.com/199），由此可以做一些很有意义的分析，比如《通过键级曲线和ELF/LOL/RDG等值面动画研究化学反应过程》（http://sobereva.com/200）、《制作动画分析电子结构特征》（http://sobereva.com/86）。</a></p><p>(2)用GAMESS-US产生wfn文件<br>在$CONTRL段落中加上AIMPAC=.TRUE.关键词，然后当任务正常运行完之后，在$SCR环境变量（由rungms脚本所定义）对应的路径下的dat文件中，把----- TOP OF INPUT FILE FOR BADER’S AIMPAC PROGRAM -----“到”----- END OF INPUT FILE FOR BADER’S AIMPAC PROGRAM -----&quot;之间的内容拷到一个文本文件里，后缀改名为wfn即可。</p><p>(3)用ORCA产生wfn文件<br>ORCA的输入文件里加上aim关键词，计算完成后就会在当前目录下产生与输入文件同名的wfn文件。或者在普通计算完成后，通过orca_2aim FFFFF命令把FFFFF.gbw转化为FFFFF.wfn。注意，ORCA产生wfn文件的功能可能有一定问题，文件格式不规矩，Windows版产生的和Linux版有一定差异，不同版本产生的还可能有差异。撰文时Multiwfn最新的版本可以支持ORCA 4.0的Windows和Linux版产生的wfn文件，但对于老版本产生的则可能不能正常载入，也不保证能支持未来ORCA版本产生的wfn文件。</p><p>并不是所有程序产生的wfn文件都能被Multiwfn正常载入和分析。比如有的程序产生的wfn文件格式不规矩，载入时必定导致程序崩溃。还有的程序，比如ADF，产生的wfn文件用的是Slater型函数，但Multiwfn只支持Gauss型函数，因此也没法正常分析。</p><h2 id="2-密度差图的种类">2 密度差图的种类</h2><p>“密度差”就是指一些体系在各自特定的状态下彼此间的密度的差值，它是三维实空间函数。有三种情况常会涉及：<br>**1 某个体系的某个状态的密度减去这个体系在另外一个状态的密度。**例如，某分子的激发态的密度减去它在基态时的密度、某分子在有外加电场时的密度减去它在自由状态下的密度。注意在计算这两个状态的密度时分子的笛卡尔坐标必须一致，不能在各自状态下分别优化，而只能共用其中一个状态的几何构型。同时也不能允许量化程序为了能利用分子对称性而自动旋转、平移坐标。否则都导致两个状态下原子坐标没法对应，密度差也就没什么意义。</p><p>**2 某个体系的密度减去组成它的各个片段的密度。**例如，水分子二聚体的密度减去这两个水分子都在孤立时的密度。同样要注意，求各个片段的密度时，它们的笛卡尔坐标必须与在整个体系中的坐标一致。</p><p><strong>3 某个体系的密度减去组成它的各个原子在自由状态下的密度，这也被称为变形密度(Deformation density)。<strong>这种密度差对于研究分子形成过程中</strong>电子密度的变化、探究化学键的本质</strong>很有用。</p><p>密度差必须作成图才便于被直观地考察，图分为三类：<br>1 曲线图：展现某条直线上密度差的数值，这种图对于密度差的研究用得较少。<br>2 平面图：能够清楚地展现一个截面上各处的密度差数值，十分有用，其中最适合展现密度差的是等值线图。平面图的缺点是难以从一个截面上了解整个空间中密度差的数值分布。<br>3 等值面图：在等值面上每个点的数值都等于人为指定的数值(这个值被称为isovalue)，通过它可以很直观地了解密度差在三维空间中的分布。但是等值面里面和外面的密度差数值没法一下子看清楚，必须反复调节isovalue考察等值面的变化才能获知。等值面图和平面图的用处是互补的。</p><p><a href="http://sobereva.com/449">用VMD绘制艺术级轨道等值面图的方法（含演示视频） - 思想家公社的门口：量子化学·分子模拟·二次元 (sobereva.com)</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/05/06/PS%E6%93%8D%E4%BD%9C/"/>
      <url>/2024/05/06/PS%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h3 id="PS操作">PS操作</h3><p><a href="https://www.bilibili.com/video/BV1qd4y1C7xr/?spm_id_from=333.788&amp;vd_source=0f97e8d36ac32961fa3f9f3519a98f07">PS制作焦散投影，期末大考核检验光影能力的时候到了！_哔哩哔哩_bilibili</a></p><ul><li><p>Ctrl+U 选择图层，调整颜色</p></li><li><p>先画多边形，再Alt+Delete 填充，Ctrl+D取消选区</p></li><li><p>图层能够建立剪切蒙版</p></li><li><p>Ctrl+T可以缩小，</p></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/04/30/%5BDeePMD%5D%E6%A8%A1%E5%9E%8B/"/>
      <url>/2024/04/30/%5BDeePMD%5D%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="DeePMD-模型">[DeePMD]模型</h3><h4 id="1-理论">1 理论</h4><p><a href="https://docs.deepmodeling.org/projects/deepmd/en/master/model/overall.html">3.1. Overall — DeePMD-kit documentation (deepmodeling.org)</a></p><h4 id="2-概述">2 概述</h4><p>模型（model）有两个部分，一个是将原子配置映射到一组对称不变特征的<strong>描述符</strong>（descriptor），另一个是以描述符为输入并预测原子对目标物理性质的贡献的<strong>拟合网</strong>（fitting net）。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&quot;model&quot;: &#123;</span><br><span class="line">    &quot;type_map&quot;:[&quot;O&quot;, &quot;H&quot;],</span><br><span class="line">    &quot;descriptor&quot; :&#123;</span><br><span class="line">        &quot;...&quot;: &quot;...&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;fitting_net&quot; : &#123;</span><br><span class="line">        &quot;...&quot;: &quot;...&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>type_map</code>是可选的，它提供相应原子类型的元素名称（但不一定与元素的实际名称相同）。在这个例子中，水模型有两种原子。原子类型在内部记录为整数，例如，0表示氧，1表示氢。<code>type_map</code>提供了从原子类型到其名称的映射。</p><table><thead><tr><th style="text-align:left">descriptors:</th><th style="text-align:left"></th></tr></thead><tbody><tr><td style="text-align:left">se_e2_a</td><td style="text-align:left">由原子构型的所有信息（角度和径向）构建。嵌入（embedding）以原子之间的距离作为输入。</td></tr><tr><td style="text-align:left">se_e2_r</td><td style="text-align:left">由原子构型的径向信息构建。嵌入（embedding）以原子之间的距离作为输入。</td></tr><tr><td style="text-align:left">se_e3</td><td style="text-align:left">由原子构型的所有信息（角度和径向）构建。嵌入以两个相邻原子之间的角度作为输入。</td></tr><tr><td style="text-align:left">se_a_mask</td><td style="text-align:left">由原子构型的所有信息（角度和径向）构建。一个系统中的输入帧可以具有不同数量的原子。输入粒子填充有相同长度的虚拟粒子。</td></tr><tr><td style="text-align:left">loc_frame</td><td style="text-align:left">在每个原子处定义一个局部帧，并将描述符计算为此帧下的局部坐标。</td></tr><tr><td style="text-align:left">hybrid</td><td style="text-align:left">合并描述符列表以形成新的描述符。</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td></tr></tbody></table><table><thead><tr><th>physical properties：</th><th></th></tr></thead><tbody><tr><td>ener</td><td>适应系统的能量。力（与原子位置的导数）和维里（与盒张量的导数）也可以训练。</td></tr><tr><td>dipole</td><td>偶极矩。</td></tr><tr><td>polar</td><td>极化率。</td></tr><tr><td></td><td></td></tr></tbody></table><h4 id="3-描述符-se-e2-a">3 描述符&quot;se_e2_a&quot;</h4><h5 id="3-1-3-2-Descriptor-“se-e2-a”-—-DeePMD-kit-documentation-deepmodeling-org">3.1 <a href="https://docs.deepmodeling.org/projects/deepmd/en/master/model/train-se-e2-a.html">3.2. Descriptor “se_e2_a” — DeePMD-kit documentation (deepmodeling.org)</a></h5><h5 id="概述">概述</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&quot;descriptor&quot; :&#123;</span><br><span class="line">    &quot;type&quot;:&quot;se_e2_a&quot;,</span><br><span class="line">    &quot;rcut_smth&quot;:0.50,</span><br><span class="line">    &quot;rcut&quot;:6.00,</span><br><span class="line">    &quot;sel&quot;:[46, 92],</span><br><span class="line">    &quot;neuron&quot;:[25, 50, 100],</span><br><span class="line">    &quot;type_one_side&quot;:true,</span><br><span class="line">    &quot;axis_neuron&quot;:16,</span><br><span class="line">    &quot;resnet_dt&quot;:false,</span><br><span class="line">    &quot;seed&quot;:1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>rcut是邻居搜索的截止半径，rcut_smth给出了平滑的开始位置。</p></li><li><p>sel给出了截止半径中的最大可能邻居数量。它是一个列表，其长度与系统中原子类型的数量相同，sel[i]表示类型为i的邻居的最大可能数量。</p></li><li><p>神经元指定嵌入网络的大小。从左到右，成员分别表示从输入端到输出端的每个隐藏层的大小。如果外层的大小是内层的两倍，则复制并连接内层，然后在它们之间构建ResNet架构。</p></li><li><p>如果选项type_one_side设置为true，则嵌入网络参数仅因相邻原子的类型而异，因此将存在</p><p>N<sub>tpyes</sub>嵌入网络参数的集合。否则，嵌入网络参数会因中心原子的类型和相邻原子的类型而异，因此会</p><p>有N<sub>tpyes</sub><sup>2</sup>嵌入网络参数的集合。</p></li><li><p>axis_neuron指定嵌入矩阵的子矩阵的大小。</p></li><li><p>如果选项resnet_dt设置为true，则在ResNet中使用时间步长。</p></li><li><p>seed给出了在初始化模型参数时用于生成随机数的随机种子。</p></li></ul><h4 id="4-描述符-se-atten">4 描述符&quot;se_atten&quot;</h4><p>DPA-1，这是一种具有新注意机制的深势模型，它对于表示原子系统的构象和化学空间以及学习PES非常有效。</p><p><a href="https://docs.deepmodeling.org/projects/deepmd/en/master/model/train-se-atten.html">3.5. Descriptor “se_atten” — DeePMD-kit documentation (deepmodeling.org)</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&quot;descriptor&quot; :&#123;</span><br><span class="line">         &quot;type&quot;:&quot;se_atten&quot;,</span><br><span class="line">         &quot;rcut_smth&quot;:0.50,</span><br><span class="line">         &quot;rcut&quot;:6.00,</span><br><span class="line">         &quot;sel&quot;:120,</span><br><span class="line">         &quot;neuron&quot;:[25, 50, 100],</span><br><span class="line">         &quot;axis_neuron&quot;:16,</span><br><span class="line">         &quot;resnet_dt&quot;:false,</span><br><span class="line">         &quot;attn&quot;:128,</span><br><span class="line">         &quot;attn_layer&quot;:2,</span><br><span class="line">         &quot;attn_mask&quot;:false,</span><br><span class="line">         &quot;attn_dotr&quot;:true,</span><br><span class="line">         &quot;seed&quot;:1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>attn sets the length of a hidden vector during scale-dot attention computation.</li><li>attn_layer设置注意力机制中的层数。</li><li>attn_mask确定是否屏蔽注意力权重中的对角线，建议为False。</li><li>attn_dotr确定是否将相对坐标点在注意力权重上作为门控方案，建议为True。</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/04/30/%5BDeePMD-kit%5D/"/>
      <url>/2024/04/30/%5BDeePMD-kit%5D/</url>
      
        <content type="html"><![CDATA[<h3 id="DeePMD-kit">[DeePMD-kit]</h3><h4 id="1-数据准备">1 数据准备</h4><p>激活环境</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate /public/home/qhs_lqr_2406/deepmd-kit</span><br></pre></td></tr></table></figure><p>CP2KData</p><p>MD计算输入中的建议设置:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">@SET frequency 100</span><br><span class="line">&amp;FORCE_EVAL</span><br><span class="line">   # if stress tensor is not need to computed, comment out the below line.</span><br><span class="line">   STRESS_TENSOR ANALYTICAL </span><br><span class="line">   &amp;PRINT</span><br><span class="line">      # if stress tensor is not need to computed, comment out the below line</span><br><span class="line">      &amp;STRESS_TENSOR ON</span><br><span class="line">      # if stress tensor is not need to computed, comment out the below line</span><br><span class="line">         &amp;EACH</span><br><span class="line">      # if stress tensor is not need to computed, comment out the below line</span><br><span class="line">            MD $&#123;frequency&#125;</span><br><span class="line">      # if stress tensor is not need to computed, comment out the below line</span><br><span class="line">         &amp;END EACH</span><br><span class="line">      # if stress tensor is not need to computed, comment out the below line</span><br><span class="line">      &amp;END STRESS_TENSOR</span><br><span class="line">   &amp;END PRINT</span><br><span class="line">&amp;END FORCE_EVAL</span><br><span class="line">&amp;MOTION</span><br><span class="line">   &amp;MD</span><br><span class="line">      &amp;PRINT</span><br><span class="line">         &amp;ENERGY</span><br><span class="line">            &amp;EACH</span><br><span class="line">               MD $&#123;frequency&#125;</span><br><span class="line">            &amp;END EACH</span><br><span class="line">         &amp;END ENERGY</span><br><span class="line">      &amp;END PRINT</span><br><span class="line">   &amp;END MD</span><br><span class="line">   &amp;PRINT</span><br><span class="line">      &amp;CELL</span><br><span class="line">         &amp;EACH</span><br><span class="line">            MD $&#123;frequency&#125;</span><br><span class="line">         &amp;END EACH</span><br><span class="line">      &amp;END CELL</span><br><span class="line">      &amp;FORCES</span><br><span class="line">         &amp;EACH</span><br><span class="line">            MD $&#123;frequency&#125;</span><br><span class="line">         &amp;END EACH</span><br><span class="line">      &amp;END FORCES</span><br><span class="line">      &amp;TRAJECTORY</span><br><span class="line">         &amp;EACH</span><br><span class="line">            MD $&#123;frequency&#125;</span><br><span class="line">         &amp;END EACH</span><br><span class="line">      &amp;END TRAJECTORY</span><br><span class="line">   &amp;END PRINT</span><br><span class="line">&amp;END MOTION</span><br></pre></td></tr></table></figure><p>解析MD输出的示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import dpdata</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line">cp2kmd_dir = &quot;./MET&quot;</span><br><span class="line">cp2kmd_output_name = &quot;MET_water.out&quot;</span><br><span class="line">data = dpdata.LabeledSystem(cp2kmd_dir, cp2k_output_name=cp2kmd_output_name, fmt=&quot;cp2kdata/md&quot;)</span><br><span class="line">print(&quot;# the data contains %d frames&quot; % len(data))</span><br><span class="line"></span><br><span class="line"># random choose 1500 index for validation_data</span><br><span class="line">rng = np.random.default_rng()</span><br><span class="line">index_validation = rng.choice(2001, size=1500, replace=False)</span><br><span class="line"></span><br><span class="line"># other indexes are training_data</span><br><span class="line">index_training = list(set(range(2001)) - set(index_validation))</span><br><span class="line">data_training = data.sub_system(index_training)</span><br><span class="line">data_validation = data.sub_system(index_validation)</span><br><span class="line"></span><br><span class="line"># all training data put into directory:&quot;training_data&quot;</span><br><span class="line">data_training.to_deepmd_npy(&quot;./00.data/training_data&quot;)</span><br><span class="line"></span><br><span class="line"># all validation data put into directory:&quot;validation_data&quot;</span><br><span class="line">data_validation.to_deepmd_npy(&quot;./00.data/validation_data&quot;)</span><br><span class="line"></span><br><span class="line">print(&quot;# the training data contains %d frames&quot; % len(data_training))</span><br><span class="line">print(&quot;# the validation data contains %d frames&quot; % len(data_validation))</span><br></pre></td></tr></table></figure><h4 id="2-准备输入脚本">2 准备输入脚本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   &quot;model&quot;: &#123;</span><br><span class="line">&quot;type_map&quot;:[&quot;O&quot;, &quot;H&quot;],</span><br><span class="line">&quot;descriptor&quot; :&#123;</span><br><span class="line">    &quot;type&quot;:&quot;se_e2_a&quot;,</span><br><span class="line">    &quot;sel&quot;:&quot;auto&quot;,</span><br><span class="line">    &quot;rcut_smth&quot;:0.50,</span><br><span class="line">    &quot;rcut&quot;:6.00,</span><br><span class="line">    &quot;neuron&quot;:[25, 50, 100],</span><br><span class="line">    &quot;resnet_dt&quot;:false,</span><br><span class="line">    &quot;axis_neuron&quot;:16,</span><br><span class="line">    &quot;seed&quot;:1,</span><br><span class="line">    &quot;_comment&quot;:&quot; that&#x27;s all&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;fitting_net&quot; : &#123;</span><br><span class="line">    &quot;neuron&quot;:[240, 240, 240],</span><br><span class="line">    &quot;resnet_dt&quot;:true,</span><br><span class="line">    &quot;seed&quot;:1,</span><br><span class="line">    &quot;_comment&quot;:&quot; that&#x27;s all&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;_comment&quot;:&quot; that&#x27;s all&quot;</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left"><strong>Parameter</strong></th><th style="text-align:left"><strong>Expiation</strong></th></tr></thead><tbody><tr><td style="text-align:left">type_map</td><td style="text-align:left"><em>the</em> <em>name</em> <em>of</em> <em>each</em> <em>type</em> <em>of</em> <em>atom</em></td></tr><tr><td style="text-align:left">descriptor &gt; type</td><td style="text-align:left"><em>the</em> <em>type</em> <em>of</em> <em>descriptor</em></td></tr><tr><td style="text-align:left">descriptor &gt; rcut</td><td style="text-align:left"><em>cut-off</em> <em>radius</em></td></tr><tr><td style="text-align:left">descriptor &gt; rcut_smth</td><td style="text-align:left"><em>where</em> <em>the</em> <em>smoothing</em> <em>starts</em></td></tr><tr><td style="text-align:left">descriptor &gt; sel</td><td style="text-align:left"><em>the</em> <em>maximum</em> <em>number</em> <em>of</em> <em>type</em> <em>i</em> <em>atoms</em> <em>in</em> <em>the</em> <em>cut-off</em> <em>radius</em></td></tr><tr><td style="text-align:left">descriptor &gt; neuron</td><td style="text-align:left"><em>size</em> <em>of</em> <em>the</em> <em>embedding</em> <em>neural</em> <em>network</em></td></tr><tr><td style="text-align:left">descriptor &gt; axis_neuron</td><td style="text-align:left"><em>the</em> <em>size</em> <em>of</em> <em>the</em> <em>submatrix</em> <em>of</em> <em>G</em> <em>(embedding</em> <em>matrix)</em></td></tr><tr><td style="text-align:left">fitting_net &gt; neuron</td><td style="text-align:left"><em>size</em> <em>of</em> <em>the</em> <em>fitting</em> <em>neural</em> <em>network</em></td></tr></tbody></table><p>The <code>se_e2_a</code> descriptor is used to train the DP model. The item neurons set the size of the descriptors and fitting network to [25, 50, 100] and [240, 240, 240], respectively. The components in local environment to smoothly go to zero from 0.5 to 6 Å.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&quot;learning_rate&quot; :&#123;</span><br><span class="line">    &quot;type&quot;:                &quot;exp&quot;,</span><br><span class="line">    &quot;decay_steps&quot;:         50,</span><br><span class="line">    &quot;start_lr&quot;:            0.001,    </span><br><span class="line">    &quot;stop_lr&quot;:             3.51e-8,</span><br><span class="line">    &quot;_comment&quot;:            &quot;that&#x27;s all&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;loss&quot; :&#123;</span><br><span class="line">    &quot;type&quot;:                &quot;ener&quot;,</span><br><span class="line">    &quot;start_pref_e&quot;:        0.02,</span><br><span class="line">    &quot;limit_pref_e&quot;:        1,</span><br><span class="line">    &quot;start_pref_f&quot;:        1000,</span><br><span class="line">    &quot;limit_pref_f&quot;:        1,</span><br><span class="line">    &quot;start_pref_v&quot;:        0,</span><br><span class="line">    &quot;limit_pref_v&quot;:        0,</span><br><span class="line">    &quot;_comment&quot;:            &quot;that&#x27;s all&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>In the loss function, <code>pref_e</code> increases from 0.02 to 1, and <code>pref_f</code> decreases from 1000 to 1 progressively, which means that the force term dominates at the beginning, while energy and virial terms become important at the end. This strategy is very effective and reduces the total training time. <code>pref_v</code> is set to 0 , indicating that no virial data are included in the training process. The starting learning rate, stop learning rate, and decay steps are set to 0.001, 3.51e-8, and 50, respectively. The model is trained for 10000 steps.</p><p>错误后重启</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dp train --restart model.ckpt input.json</span><br></pre></td></tr></table></figure><h4 id="训练模型">训练模型</h4><h4 id="冻结-压缩模型">冻结/压缩模型</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dp freeze -o graph.pb</span><br><span class="line"></span><br><span class="line">dp compress -i graph.pb -o graph-compress.pb</span><br></pre></td></tr></table></figure><h4 id="测试模型">测试模型</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dp test -m graph-compress.pb -s ../00.data/validation_data -n 40 -d results</span><br></pre></td></tr></table></figure><h4 id="模型运用">模型运用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s ../01.train/graph-compress.pb</span><br></pre></td></tr></table></figure><p>lammps模板</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#in文件模板</span><br><span class="line">#----------1 模拟参数--------------------</span><br><span class="line">units           metal</span><br><span class="line">boundary        p p p</span><br><span class="line">atom_style      atomic</span><br><span class="line">timestep        0.001</span><br><span class="line">neighbor        2.0 bin</span><br><span class="line">neigh_modify    delay 0 every 5 check yes</span><br><span class="line">#----------2 体系模型的建立----------------</span><br><span class="line">variable        xbox index 100         </span><br><span class="line">variable        ybox index 100         </span><br><span class="line">variable        zbox index 100         </span><br><span class="line">region          simulationbox block 0 $&#123;xbox&#125; 0 $&#123;ybox&#125;  0  $&#123;zbox&#125;  units box   </span><br><span class="line">create_box      1 simulationbox    </span><br><span class="line">lattice         fcc 3.61</span><br><span class="line">region          cu  block $&#123;xstbox&#125; $&#123;xtbox&#125; $&#123;ystbox&#125; $&#123;ytbox&#125; $&#123;zstbox&#125; $&#123;ztbox&#125; units box </span><br><span class="line">create_atoms    1 region cu         </span><br><span class="line">mass            1   64     </span><br><span class="line">#输出原子初始结构</span><br><span class="line">write_data   test.data                    </span><br><span class="line">#----------3 力场的设置-------</span><br><span class="line">pair_style   eam/fs</span><br><span class="line">pair_coeff   * * Cu.eam.fs Cu</span><br><span class="line">#----------4 能量最小化-------</span><br><span class="line">thermo    100</span><br><span class="line">thermo_style  custom step press pe temp ke</span><br><span class="line">dump    1 all atom 100 mini.lammpstrj</span><br><span class="line">min_style  cg</span><br><span class="line">minimize  1e-15 1e-15 5000 5000</span><br><span class="line">undump    1</span><br><span class="line">reset_timestep  0</span><br><span class="line">#-----------5 温度初始化--------</span><br><span class="line">velocity  all create 300 321456 rot yes dist gaussian </span><br><span class="line">#-----------6 弛豫-------------</span><br><span class="line">thermo    100</span><br><span class="line">thermo_style  custom step press pe temp ke</span><br><span class="line">dump    1 all atom 100 mini.lammpstrj</span><br><span class="line">fix    1 all nvt temp 300 300 0.1 </span><br><span class="line">run    10000</span><br><span class="line">unfix    1</span><br><span class="line">undump    1</span><br><span class="line">reset_timestep 0</span><br><span class="line">#-------7 具体模拟设置-------</span><br><span class="line">thermo    100</span><br><span class="line">thermo_style  custom step press pe temp ke</span><br><span class="line">dump    1 all atom 100 mini.lammpstrj</span><br><span class="line">fix    1 all npt temp 300 300 1 y 0 0 1 z 0 0 1 drag 1</span><br><span class="line">variable  srate equal 1.0e10</span><br><span class="line">variable  srate1 equal &quot;-v_srate / 1.0e12&quot;</span><br><span class="line">fix    2 all deform 1 x erate $&#123;srate1&#125; units box remap x</span><br><span class="line">run    100000</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/04/25/%E5%BE%84%E5%90%91%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0/"/>
      <url>/2024/04/25/%E5%BE%84%E5%90%91%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="径向分布函数">径向分布函数</h3><p>$$<br>在统计力学中，径向分布函数，（或对相关函数）g®在粒子（原子、分子、胶体等）系统中，描述了密度如何作为与参考粒子距离的函数而变化。<br>$$</p><h3 id="GROMACS插入水分子到系统中">GROMACS插入水分子到系统中</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi insert-molecules -f CuSO4.pdb -ci water.pdb -o CuSO4_water.pdb -nmol 80</span><br></pre></td></tr></table></figure><p>需要手动检查CuSO4_water.pdb文件，金属离子出现错误，需要手动修改，将“空格U”替换为“Cu”。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/04/20/%E7%AC%AC%E5%9B%9B%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/20/%E7%AC%AC%E5%9B%9B%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="GROMACS-产生SO4的GROMACS的拓扑和gro文件：力常数全基于Hessian计算得到">[GROMACS]<strong>产生SO4的GROMACS的拓扑和gro文件：力常数全基于Hessian计算得到</strong></h2><h3 id="1-Gaussian对SO4做优化和振动分析">1 Gaussian对SO4做优化和振动分析</h3><p>首先用Gaussian对SO4做优化+振动分析并保留.fch/fchk文件，里面包含了要用的笛卡尔Hessian矩阵和优化后的坐标信息。然后把优化后的结构保存成mol2文件。注意此文件里的键连关系必须和实际要产生的力场项对应，在GaussView里可以肉眼检查，不符的话就调整。只要连接关系正确就行，而成键方式随意。本例中，使用对于无机刚性体系都可以得到拓扑文件。</p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">%chk=SO4.chk</span><br><span class="line">#p tpssh/def2tzvp opt freq</span><br><span class="line"></span><br><span class="line">Molecule Name</span><br><span class="line"></span><br><span class="line">-2 1</span><br><span class="line"> S                  0.80990000   12.41490000    8.99380000</span><br><span class="line"> O                  1.83470000   12.61620000   10.04100000</span><br><span class="line"> O                 -0.47150000   12.99740000    9.43000000</span><br><span class="line"> O                  1.25950000   13.15250000    7.77620000</span><br><span class="line"> O                  0.65810000   11.01280000    8.68580000</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>将<code>.mol2</code> 文件载入Sobtop，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">2 //产生gro文件</span><br><span class="line">[回车] //默认的gro文件产生路径</span><br><span class="line">-1 //设置产生力常数的方法</span><br><span class="line">4 //DRIH方法</span><br><span class="line">1 //产生GROMACS拓扑文件</span><br><span class="line">2 //指认GAFF原子类型，没法指认的自动用UFF原子类型</span><br><span class="line">2 //所有力常数都通过DRIH方法得到</span><br><span class="line">SO4.fchk　//Gaussian的freq任务得到的，用于给Sobtop提供Hessian矩阵。这一步用ORCA的freq任务产生的.hess文件、xtb的--ohess任务产生的名为hessian的文件、CP2K振动分析的输出文件亦可</span><br><span class="line">[回车] //用默认的top文件产生路径</span><br><span class="line">[回车] //用默认的itp文件产生路径</span><br></pre></td></tr></table></figure><p>当前目录下已经有了SO4.itp、SO4.top和SO4.gro。此例原子类型都是GAFF的，平衡键长来自SO4.fchk，力常数使用DRIH方法基于Hessian产生。SO4.itp里包含的是SO4分子的拓扑信息，包括定义此分子的[ moleculetype ]字段，以及定义其中涉及到的原子类型的[ atomtypes ]字段。由[ moleculetype ]下面的信息可见Sobtop自动设的分子名就是结构文件去除后缀后的名字。SO4.top是主top文件，包含了GAFF/AMBER力场下模拟适用的[ defaults ]字段、整个体系名[ system ]字段，以及分子数目字段[ molecules ]。</p><p>等价性RESP电荷计算，启动Multiwfn，然后载入<code>.fchk</code> 文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7  //计算原子电荷</span><br><span class="line">18  //计算RESP电荷</span><br><span class="line">5  //等价性约束设置</span><br><span class="line">11  //根据点群自动判断等价性</span><br><span class="line">a  //根据整个体系的结构判断点群</span><br><span class="line">y  //当前屏幕上显示的点群是，列出的原子等价性没错，所以这里输入y确认。然后当前目录下有了等价性设置文件eqvcons_PG.txt</span><br><span class="line">q  //返回</span><br><span class="line">1  //从文本文件里读取等价性设置</span><br><span class="line">eqvcons_PG.txt  //刚才产生的文件</span><br><span class="line">2  //开始一步式RESP电荷拟合</span><br><span class="line">[回车]  //程序提示缺半径，按回车表示用推荐的半径</span><br><span class="line">Multiwfn算RESP电荷效率很高，RESP电荷很快就产生了，从屏幕上给出的结果看确实原子电荷合理，而且满足等价性。按y把产生的原子电荷导出为当前目录下的.chg。</span><br></pre></td></tr></table></figure><p>得到<code>SO4.chg</code> 文件，手动修改上一步得到的<code>SO4.itp</code> 文件。</p><h3 id="2-Packmol建模">2 Packmol建模</h3><p><strong>注意事项：</strong> 由于建模的<code>.pbd</code> 文件会用于后续的GROMACS模拟，因此格式非常重要。（常常需要手动修改原子的名称，确保其不重复）</p><p>其中，Cu-MET.pdb：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">HETATM    1 Cu1  MOL A   1       6.196   3.873   2.351                      Cu</span><br><span class="line">HETATM    2 N2   MOL A   1       3.186   5.020   2.737                       N</span><br><span class="line">HETATM    3 H3   MOL A   1       2.289   5.358   3.053                       H</span><br><span class="line">HETATM    4 N4   MOL A   1       2.107   2.991   2.520                       N</span><br><span class="line">HETATM    5 N5   MOL A   1       5.424   5.638   2.437                       N</span><br><span class="line">HETATM    6 H6   MOL A   1       6.029   6.426   2.230                       H</span><br><span class="line">HETATM    7 N7   MOL A   1       3.747   7.242   2.688                       N</span><br><span class="line">HETATM    8 H8   MOL A   1       4.405   8.006   2.672                       H</span><br><span class="line">HETATM    9 H9   MOL A   1       2.773   7.490   2.604                       H</span><br><span class="line">HETATM   10 C10  MOL A   1       3.271   3.653   2.523                       C</span><br><span class="line">HETATM   11 C11  MOL A   1       4.174   5.972   2.603                       C</span><br><span class="line">HETATM   12 C12  MOL A   1       2.114   1.523   2.458                       C</span><br><span class="line">HETATM   13 H13  MOL A   1       2.352   1.170   1.451                       H</span><br><span class="line">HETATM   14 H14  MOL A   1       1.125   1.164   2.728                       H</span><br><span class="line">HETATM   15 H15  MOL A   1       2.827   1.118   3.179                       H</span><br><span class="line">HETATM   16 C16  MOL A   1       0.807   3.684   2.522                       C</span><br><span class="line">HETATM   17 H17  MOL A   1       0.565   4.082   3.513                       H</span><br><span class="line">HETATM   18 H18  MOL A   1       0.040   2.962   2.255                       H</span><br><span class="line">HETATM   19 H19  MOL A   1       0.788   4.477   1.772                       H</span><br><span class="line">HETATM   20 O20  MOL A   1       7.172   2.159   1.707                       O</span><br><span class="line">HETATM   21 H21  MOL A   1       7.011   1.625   0.916                       H</span><br><span class="line">HETATM   22 H22  MOL A   1       7.384   1.567   2.447                       H</span><br><span class="line">HETATM   23 N23  MOL A   1       4.444   3.078   2.364                       N</span><br><span class="line">HETATM   24 H24  MOL A   1       4.373   2.098   2.120                       H</span><br><span class="line">HETATM   25 O25  MOL A   1       6.962   2.784   4.378                       O</span><br><span class="line">HETATM   26 H26  MOL A   1       7.752   2.972   4.906                       H</span><br><span class="line">HETATM   27 H27  MOL A   1       6.297   2.493   5.018                       H</span><br><span class="line">HETATM   28 O28  MOL A   1       8.054   4.709   2.129                       O</span><br><span class="line">HETATM   29 H29  MOL A   1       8.730   4.173   1.688                       H</span><br><span class="line">HETATM   30 H30  MOL A   1       8.503   5.278   2.770                       H</span><br><span class="line">END</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>SO4.pdb:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HETATM    1  S1   MOL A   1       0.000   0.000  -0.000  1.00  0.00           S</span><br><span class="line">HETATM    2  O2   MOL A   1       1.140   0.968  -0.153  1.00  0.00           O</span><br><span class="line">HETATM    3  O3   MOL A   1      -1.304   0.740  -0.110  1.00  0.00           O</span><br><span class="line">HETATM    4  O4   MOL A   1       0.078  -1.041  -1.082  1.00  0.00           O</span><br><span class="line">HETATM    5  O5   MOL A   1       0.086  -0.667   1.345  1.00  0.00           O</span><br><span class="line">END</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>将上面文件合并成一个pdb文件，<code>mix_in.pdb</code>使用GaussView观察结构的合理性(注意合并的格式需要保持一致)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">HETATM    1 Cu1  MOL A   1       6.196   3.873   2.351                      Cu</span><br><span class="line">HETATM    2 N2   MOL A   1       3.186   5.020   2.737                       N</span><br><span class="line">HETATM    3 H3   MOL A   1       2.289   5.358   3.053                       H</span><br><span class="line">HETATM    4 N4   MOL A   1       2.107   2.991   2.520                       N</span><br><span class="line">HETATM    5 N5   MOL A   1       5.424   5.638   2.437                       N</span><br><span class="line">HETATM    6 H6   MOL A   1       6.029   6.426   2.230                       H</span><br><span class="line">HETATM    7 N7   MOL A   1       3.747   7.242   2.688                       N</span><br><span class="line">HETATM    8 H8   MOL A   1       4.405   8.006   2.672                       H</span><br><span class="line">HETATM    9 H9   MOL A   1       2.773   7.490   2.604                       H</span><br><span class="line">HETATM   10 C10  MOL A   1       3.271   3.653   2.523                       C</span><br><span class="line">HETATM   11 C11  MOL A   1       4.174   5.972   2.603                       C</span><br><span class="line">HETATM   12 C12  MOL A   1       2.114   1.523   2.458                       C</span><br><span class="line">HETATM   13 H13  MOL A   1       2.352   1.170   1.451                       H</span><br><span class="line">HETATM   14 H14  MOL A   1       1.125   1.164   2.728                       H</span><br><span class="line">HETATM   15 H15  MOL A   1       2.827   1.118   3.179                       H</span><br><span class="line">HETATM   16 C16  MOL A   1       0.807   3.684   2.522                       C</span><br><span class="line">HETATM   17 H17  MOL A   1       0.565   4.082   3.513                       H</span><br><span class="line">HETATM   18 H18  MOL A   1       0.040   2.962   2.255                       H</span><br><span class="line">HETATM   19 H19  MOL A   1       0.788   4.477   1.772                       H</span><br><span class="line">HETATM   20 O20  MOL A   1       7.172   2.159   1.707                       O</span><br><span class="line">HETATM   21 H21  MOL A   1       7.011   1.625   0.916                       H</span><br><span class="line">HETATM   22 H22  MOL A   1       7.384   1.567   2.447                       H</span><br><span class="line">HETATM   23 N23  MOL A   1       4.444   3.078   2.364                       N</span><br><span class="line">HETATM   24 H24  MOL A   1       4.373   2.098   2.120                       H</span><br><span class="line">HETATM   25 O25  MOL A   1       6.962   2.784   4.378                       O</span><br><span class="line">HETATM   26 H26  MOL A   1       7.752   2.972   4.906                       H</span><br><span class="line">HETATM   27 H27  MOL A   1       6.297   2.493   5.018                       H</span><br><span class="line">HETATM   28 O28  MOL A   1       8.054   4.709   2.129                       O</span><br><span class="line">HETATM   29 H29  MOL A   1       8.730   4.173   1.688                       H</span><br><span class="line">HETATM   30 H30  MOL A   1       8.503   5.278   2.770                       H</span><br><span class="line">HETATM   1  S1   MOL A   1       0.000   0.000  -0.000                       S</span><br><span class="line">HETATM   2  O2   MOL A   1       1.140   0.968  -0.153                       O</span><br><span class="line">HETATM   3  O3   MOL A   1      -1.304   0.740  -0.110                       O</span><br><span class="line">HETATM   4  O4   MOL A   1       0.078  -1.041  -1.082                       O</span><br><span class="line">HETATM   5  O5   MOL A   1       0.086  -0.667   1.345                       O</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>然后构建Packmol输入文件<code>mix.inp</code>：(注意合并的格式需要保持一致)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tolerance 2.0</span><br><span class="line">add_box_sides 1.2</span><br><span class="line">output mix_out.pdb</span><br><span class="line">structure mix_in.pdb</span><br><span class="line">  number 1000</span><br><span class="line">  inside cube 0. 0. 0. 100.</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>建模需要根据实际情况设置分子的个数，之后使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi editconf -f mix_out.pdb -o mix_out.gro</span><br></pre></td></tr></table></figure><p>将<code>.pdb</code>转化为<code>.gro</code> 文件。使用VScode进行编辑的时候需要用到多行匹配：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(.*?)(S1).*(?:.|\n).*(?:.|\n).*(?:.|\n).*(?:.|\n).*</span><br></pre></td></tr></table></figure><p>删除空行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^\s*(?=\r?$)\n</span><br></pre></td></tr></table></figure><p>建模使用的GROMACS语句，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi solvate -cp conf.gro -o conf.gro -cs tip4p -p topol.top -box 2.3 2.3 2.3</span><br></pre></td></tr></table></figure><p>能量最小化：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi grompp -f mdp/min.mdp -o min.tpr -pp min.top -po min.mdp</span><br><span class="line">$ gmx_mpi mdrun -s min.tpr -o min.trr -x min.xtc -c min.gro -e min.edr -g min.log</span><br><span class="line"></span><br><span class="line">$ gmx_mpi grompp -f mdp/min2.mdp -o min2.tpr -pp min2.top -po min2.mdp -c min.gro</span><br><span class="line">$ gmx_mpi mdrun -s min2.tpr -o min2.trr -x min2.xtc -c min2.gro -e min2.edr -g min2.log</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第二篇博客</title>
      <link href="/2024/04/15/%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/15/%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="Nanomotors">[Nanomotors]</h2><h3 id="期刊：Journal-of-the-American-Chemical-Society">期刊：Journal of the American Chemical Society</h3><h3 id="Rotary-F-sub-0-sub-F-sub-1-sub-ATP-Synthase-Driven-Flasklike-Pentosan-Colloidal-Motors-with-ATP-Synthesis-and-Storage">Rotary F<sub>0</sub>F<sub>1</sub>-ATP Synthase-Driven Flasklike Pentosan Colloidal Motors with ATP Synthesis and Storage</h3><p>摘要：文章介绍了一种叶绿体衍生的“F<sub>o</sub>F<sub>1</sub>-ATPase motor-propelled flasklike pentosan</p><p>colloidal motor (FPCM)” 的分层组装，其具有合成、存储和触发生物能量货币ATP的能力。通过结合软模板水热聚合和真空注入含有F<sub>o</sub>F<sub>1</sub>-ATPase的脂质体来制备。注入酸性缓冲溶液，质子驱动F<sub>o</sub>F<sub>1</sub>-ATPase的旋转，从而促进FPCMs的运动，并伴随内部ATP的合成和存储。</p><span id="more"></span><h4 id="示意图：">示意图：</h4><p><img src="JACS1.png" alt></p><p><strong>实验方法：</strong></p><p><strong>PREPARATION OF THE RBMPS.</strong></p><p>​Chloroplasts were isolated from <strong>fresh spinach</strong> using a method similar to that reported previously. Briefly, 500 g of fresh spinach were grated with quartz sand in a mortar and added to a <strong>chloroplast buffer</strong> containing 0.4 M sucrose, 0.01 M KCl, 0.01 M Na<sub>2</sub>HPO<sub>4</sub>, 0.03 M KH<sub>2</sub>PO<sub>4</sub>, and 2 mM vitamin C in 40 ml. The homogenate was collected in a centrifuge tube and filtered through eight layers of cotton gauze. The supernatant was collected after centrifuging the filtrate at <strong>3000 g for 2 min</strong>. Gradient density centrifugation was used to separate intact chloroplasts during the second centrifuge filtrate. The intact chloroplasts were washed three times with 10 ml of buffer, and a green suspension was obtained. The recycled chloroplast pellet was suspended in a solution containing 10 mM HEPES-KOH (pH=7.8) and 5 mM MgCl<sub>2</sub> and allowed to stand for 15 min in the dark on ice to lyse the chloroplasts. Thylakoids were sedimented by centrifugation at <strong>3000 g for 3 min</strong> and resuspended in a solution containing 50 mM HEPES-KOH (pH 7.5), 100 mM sorbitol, and 10 mM MgCl<sub>2</sub>. The stacked thylakoids were homogenized in a glass homogenizer for 5 min in an ice bath. The resulting mixed solution was extruded through porous <strong>800 nm</strong> polycarbonate membrane filters to remove larger thylakoid fragments. Then thylakoid fragments were further mechanically extruded through a porous polycarbonate membrane with a diameter of <strong>100 nm</strong> for fabrication of thylakoid vesicles. The recovered thylakoid vesicles were then uniformly mixed with phospholipid vesicles and extruded through a 100 nm polycarbonate membrane 21 times to obtain RBMPs. Finally, the clear light green solution was stored in the dark at 4 °C.</p><p><strong>PREPARATION OF THE FPCMS.</strong></p><p>The flasklike colloidal motors were prepared using a previously established method. In brief, a clear solution was formed by slowly stirring 0.0365 g of sodium oleate (SO) and 0.0435 g of Poly (ethylene glycol)-block-poly (propylene glycol)-block-poly-(ethylene glycol) (EO20-PO70-EO20, P123) in 20 mL of deionized water. Next, 40 mL of a solution containing 3 g of <strong>ribose</strong> was added and the resulting mixture was stirred for 30 minutes before being transferred to a 100 mL autoclave and placed in an oven at 160 °C for 10 hours. The resulting products were collected, washed by centrifugation, and then dried and stored as flask-like pentosan colloidal particles. To prepare the FPCMs, 0.5 mg of the particles were added to a solution containing 9 mg of RBMPs in 1 mL of ADP buffer solution. This solution was placed in a vacuum chamber at a pressure of -0.1 bar for 30 minutes and then ultrasonicated for 1 hour at 0 °C. The resulting motors were washed three times with ADP buffer solution by centrifugation and finally stored in the same solution at 4 °C.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第三篇博客</title>
      <link href="/2024/04/15/%E7%AC%AC%E4%B8%89%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/15/%E7%AC%AC%E4%B8%89%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="GROMACS-使用Sobtop创建Cu-MET的拓扑文件-学习记录（二）">[GROMACS]使用Sobtop创建Cu-MET的拓扑文件 - 学习记录（二）</h2><h3 id="1使用Gaussian做优化和振动分析">1使用Gaussian做优化和振动分析</h3><p>从<a href="https://www.ccdc.cam.ac.uk/">Advancing Structural Science | CCDC (cam.ac.uk)</a> 获得Cu-MET分子结构文件<code>.mol2</code> 。去掉多余的阴离子，并写入体系的电荷，和<strong>自旋多重度</strong>=2S + 1,（对于铜离子，我是这样理解的，其最外层电子结构为3d9， 可能自旋多重度为2 ，4， 6 …）。对于过度金属配合物，选择TPSSh/def2-TZVP级别进行计算。输入文件：</p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">%chk=Cu-MET.chk</span><br><span class="line">#p tpssh/def2tzvp opt freq</span><br><span class="line"></span><br><span class="line">Molecule Name</span><br><span class="line"></span><br><span class="line">2 2</span><br><span class="line"> Cu                 0.68340000   11.65550000    4.11380000</span><br><span class="line"> N                  1.33280000    8.49740000    4.66170000</span><br><span class="line"> H                  1.55210000    7.67890000    4.81240000</span><br><span class="line"> N                  1.31460000    7.86950000    2.44020000</span><br><span class="line"> N                  0.90890000   10.57550000    5.67970000</span><br><span class="line"> H                  0.82250000   10.98660000    6.43030000</span><br><span class="line"> N                  1.30830000    8.68050000    6.95030000</span><br><span class="line"> H                  1.21690000    9.12340000    7.68160000</span><br><span class="line"> H                  1.48430000    7.83770000    6.97690000</span><br><span class="line"> C                  1.17630000    8.86180000    3.32770000</span><br><span class="line"> C                  1.17530000    9.30280000    5.76600000</span><br><span class="line"> C                  1.38130000    8.17970000    1.00880000</span><br><span class="line"> H                  0.50800000    8.08810000    0.62020000</span><br><span class="line"> H                  1.98860000    7.57420000    0.57790000</span><br><span class="line"> H                  1.69030000    9.08230000    0.89120000</span><br><span class="line"> C                  1.34520000    6.46410000    2.78100000</span><br><span class="line"> H                  2.19410000    6.24920000    3.17330000</span><br><span class="line"> H                  1.21660000    5.94090000    1.98720000</span><br><span class="line"> H                  0.64440000    6.27350000    3.40850000</span><br><span class="line"> O                 -0.25100000   12.62370000    2.64970000</span><br><span class="line"> H                 -0.88640000   12.12100000    2.25180000</span><br><span class="line"> H                  0.29530000   12.80310000    1.95320000</span><br><span class="line"> N                  0.91290000   10.09890000    3.00980000</span><br><span class="line"> H                  0.82810000   10.24100000    2.16550000</span><br><span class="line"> O                  2.91340000   12.56390000    3.55830000</span><br><span class="line"> H                  3.00980000   13.33380000    4.02780000</span><br><span class="line"> H                  3.45680000   11.87430000    3.25050000</span><br><span class="line"> O                  0.51290000   13.25530000    5.25800000</span><br><span class="line"> H                  0.80900000   14.03840000    4.85740000</span><br><span class="line"> H                  1.05740000   13.24220000    6.00580000</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>之后，使用formchk转化文件格式。使用GaussView打开<code>.fchk</code> 文件，确定连接情况（只看连接），然后保存文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$formchk Cu-MET.chk</span><br></pre></td></tr></table></figure><h3 id="2-计算RESP电荷">2 计算RESP电荷</h3><p>标准RESP电荷计算：<code>.fchk</code> 文件载入Multiwfn，依次输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">7  //布居分析与原子电荷计算</span><br><span class="line">18  //RESP模块</span><br><span class="line">1  //计算标准RESP电荷</span><br></pre></td></tr></table></figure><p>对于对称性高的的配合物，应当设置等价性：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7  //计算原子电荷</span><br><span class="line">18  //计算RESP电荷</span><br><span class="line">5  //等价性约束设置</span><br><span class="line">11  //根据点群自动判断等价性</span><br><span class="line">a  //根据整个体系的结构判断点群</span><br><span class="line">y  //当前屏幕上显示的点群确实是xxx，列出的原子等价性没错，所以这里输入y确认。然后当前目录下有了等价性设置文件eqvcons_PG.txt</span><br><span class="line">q  //返回</span><br><span class="line">1  //从文本文件里读取等价性设置</span><br><span class="line">eqvcons_PG.txt  //刚才产生的文件</span><br><span class="line">2  //开始一步式RESP电荷拟合</span><br><span class="line">[回车]  //程序提示,缺半径，按回车表示用推荐的半径</span><br><span class="line">Multiwfn算RESP电荷效率很高，RESP电荷很快就产生了，从屏幕上给出的结果看确实原子电荷合理，而且满足等价性。按y把产生的原子电荷导出为当前目录下的xxx.chg。</span><br></pre></td></tr></table></figure><h3 id="3-用Sobtop产生拓扑文件">3 用Sobtop产生拓扑文件</h3><p>将<code>Cu-MET.mol2</code> 载入Sobtop，然后输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7  //指定原子电荷</span><br><span class="line">10  //从Multiwfn的chg文件中读取原子电荷</span><br><span class="line">Cu-MET.chg</span><br><span class="line">0  //返回</span><br><span class="line">2  //产生GROMACS的.gro文件</span><br><span class="line">[回车]  //此时当前目录下产生了Cu-MET.gro</span><br><span class="line">1  //产生GROMACS的拓扑文件</span><br><span class="line">2  //优先用GAFF原子类型，缺的自动用UFF力场的。原子类型决定了拓扑文件里的LJ参数</span><br><span class="line">2  //所有成键相关参数基于振动分析产生的fchk文件里的Hessian矩阵生成</span><br><span class="line">Cu-MET.fchk  //如果此文件和Cu-MET.mol2在相同目录下，此处直接按回车可以快捷载入</span><br><span class="line">[回车]  //在当前目录下产生Cu-MET.top</span><br><span class="line">[回车]  //在当前目录下产生Cu-MET.itp</span><br></pre></td></tr></table></figure><p><strong>注意事项：</strong> 我在载入<code>.mol2</code> 文件的时候出现了，程序闪退的现象。然后使用Multiwfn将Gaussian的<code>.fchk</code> 文件转换为<code>.pdb</code> 文件，之后使用GaussView将<code>.pdb</code> 转化为<code>.mol2</code> ，再次载入Sobtop，就不会出现闪退了。但是，之后载入<code>.chg</code> 文件 出现闪退。我的解决方案是，不载入<code>.chg</code> 文件，将生成的<code>.itp</code> 文件，手动修改电荷。</p><h3 id="4-测试拓扑文件的合理性">4 测试拓扑文件的合理性</h3><p>根据<a href="https://manual.gromacs.org/current/user-guide/mdp-options.html">Molecular dynamics parameters (.mdp options) - GROMACS 2024.1 documentation</a> 设置参数，理解各个选项的含义。NVT模拟，在<code>.gro</code> 文件设置盒子的大小，方向。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.001     ; 2 fs</span><br><span class="line">nsteps                   = 100000     ;  ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 500</span><br><span class="line">nstlog                   = 500</span><br><span class="line">nstxout-compressed       = 500</span><br><span class="line"></span><br><span class="line">gen-vel                  = yes</span><br><span class="line">gen-temp                 = 298.15</span><br><span class="line"></span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br></pre></td></tr></table></figure><p>计算方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi grompp -f md.mdp -c Cu-MET.gro -p Cu-MET.top -o md.tpr</span><br><span class="line">$gmx_mpi mdrun -v -deffnm md</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第一篇博客</title>
      <link href="/2024/04/15/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/15/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="GROMACS-Water-学习记录（一）">[GROMACS] Water - 学习记录（一）</h2><span id="more"></span><h3 id="概述">概述</h3><p>GROMACS模拟需要三个必须的文件：</p><ul><li><p>结构文件（.gro/.pdb） - 包含每个原子的笛卡尔坐标。</p></li><li><p>拓扑文件（.top） - 包含键相互作用，非键相互作用。</p></li><li><p>输入文件（.mdp） - 包含如何运行这个系统的参数。</p><h4 id="拓扑文件">拓扑文件</h4><p>拓扑文件通过使用 <code>#include</code>  来使用力场参数。创建一个<code>topol.top</code> 文件，如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;oplsaa.ff/forcefield.itp&quot;</span><br><span class="line">#include &quot;oplsaa.ff/tip4pew.itp&quot;</span><br><span class="line"></span><br><span class="line">[ System ]</span><br><span class="line">TIP4PEW</span><br><span class="line"></span><br><span class="line">[ Molecules ]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>其中，使用OPLS-AA力场，水分子使用TIP4PEW模型。<code>[System]</code> 字段定义的是系统的名字，可以随便设置。 <code>[Molecules]</code> 字段 定于分子的<strong>名字和个数</strong>。</p><h4 id="结构文件">结构文件</h4><p>TIP4PEW结构文件，在GROMACS中已经提供。可以在<code>$GMXDATA/top</code> 中找到。<code>tip4p.gro</code> 截取部分如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">216 TIP4P Water Molecules Equilibrated for 20 ps at 300 K </span><br><span class="line">  864</span><br><span class="line">    1SOL     OW    1   1.736   0.839   0.257 -0.0525 -0.0128  0.1333</span><br><span class="line">    1SOL    HW1    2   1.777   0.781   0.322  0.3406  0.5030  0.3534</span><br><span class="line">    1SOL    HW2    3   1.643   0.831   0.274  0.0528  0.2742  0.9186</span><br></pre></td></tr></table></figure><p>其中，第一行是注释行，无关紧要。第二行是分子个数。（<strong>原子类型需要保证不一致</strong>）</p><p>之后，溶剂化体系（<strong>GROMACS我使用的是mpi的并行运算</strong>）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi solvate -cs tip4p -o conf.gro -box 2.3 2.3 2.3 -p topol.top</span><br></pre></td></tr></table></figure><p>使用2.3 nm的盒子中，填充水分子。</p><h4 id="输入文件">输入文件</h4><p>模拟通常包括3个部分：能量最小化 - 温度和压力平衡 - 模拟生产。</p><h5 id="能量最小化">能量最小化</h5><p>创建mdp文件夹，其中包含运行的输入文件，目录结构如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mdp/</span><br><span class="line">- min.mdp</span><br><span class="line">- min2.mdp</span><br><span class="line">- eql.mdp</span><br><span class="line">- eql2.mdp</span><br><span class="line">- prd.mdp</span><br></pre></td></tr></table></figure><p>其中，min.mdp代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">define                   = -DFLEXIBLE</span><br><span class="line">integrator               = steep</span><br><span class="line">nsteps                   = 100000</span><br><span class="line"></span><br><span class="line">nstenergy                = 500</span><br><span class="line">nstlog                   = 500</span><br><span class="line">nstxout-compressed       = 1000</span><br><span class="line"></span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br></pre></td></tr></table></figure><p>在mdp文件夹同一位置运行如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi grompp -f mdp/min.mdp -o min.tpr -pp min.top -po min.mdp</span><br><span class="line">$ gmx_mpi mdrun -s min.tpr -o min.trr -x min.xtc -c min.gro -e min.edr -g min.log</span><br><span class="line"></span><br><span class="line">$ gmx_mpi grompp -f mdp/min2.mdp -o min2.tpr -pp min2.top -po min2.mdp -c min.gro</span><br><span class="line">$ gmx_mpi mdrun -s min2.tpr -o min2.trr -x min2.xtc -c min2.gro -e min2.edr -g min2.log</span><br></pre></td></tr></table></figure><p>其中，<code>-f</code> 指向输入文件，如果没有<code>-c</code> 和<code>-p</code> 标志，意味着GROMACS使用默认的结构文件<code>conf.gro</code>  和拓扑文件<code>topol.top</code> ，因此这个两个文件也必须和mdp文件夹在同一目录。</p><p>注意事项：在模拟过程中，可能出现<code>Warning</code> 警告，如何是和L-BFGS的效率相关，可以使用<code>-maxwarn 1</code> 忽略掉，如果是其他的警告，需要仔细查看。</p><p>可以使用GROMACS输出相关的能量（<strong>代码运行之后，你需要选择输出的能量文件</strong>）文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi energy -f min.edr -o min-energy.xvg</span><br></pre></td></tr></table></figure><h5 id="温度和压力平衡">温度和压力平衡</h5><p>这一步需要进行温度和压力平衡，其中温度平恒eql.mdp文件如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.002     ; 2 fs</span><br><span class="line">nsteps                   = 500000     ; 1 ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 200</span><br><span class="line">nstlog                   = 2000</span><br><span class="line">nstxout-compressed       = 10000</span><br><span class="line"></span><br><span class="line">gen-vel                  = yes</span><br><span class="line">gen-temp                 = 298.15</span><br><span class="line"></span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br></pre></td></tr></table></figure><p>运行过程如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi grompp -f mdp/eql.mdp -o eql.tpr -pp eql.top -po eql.mdp -c min2.gro</span><br><span class="line">$gmx_mpi mdrun -s eql.tpr -o eql.trr -x eql.xtc -c eql.gro -e eql.edr -g eql.log</span><br><span class="line"></span><br><span class="line">$gmx_mpi energy -f eql.edr -o eql-temp.xvg</span><br></pre></td></tr></table></figure><p>压力平衡文件，eql2.mdp文件如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.002     ; 2 fs</span><br><span class="line">nsteps                   = 1000000    ; 1.0 ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 200</span><br><span class="line">nstlog                   = 2000</span><br><span class="line">nstxout-compressed       = 10000</span><br><span class="line"></span><br><span class="line">continuation             = yes</span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br><span class="line"></span><br><span class="line">pcoupl                   = Parrinello-Rahman </span><br><span class="line">tau_p                    = 4.0</span><br><span class="line">compressibility          = 4.46e-5</span><br><span class="line">ref_p                    = 1.0 </span><br></pre></td></tr></table></figure><p>运行过程如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi grompp -f mdp/eql2.mdp -o eql2.tpr -pp eql2.top -po eql2.mdp -c eql.gro</span><br><span class="line">$ gmx_mpi mdrun -s eql2.tpr -o eql2.trr -x eql2.xtc -c eql2.gro -e eql2.edr -g eql2.log</span><br></pre></td></tr></table></figure><h5 id="模拟生产">模拟生产</h5><p>模拟生产prd.mdp文件如下:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.002     ; 2 fs</span><br><span class="line">nsteps                   = 5000000   ; 10.0 ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 5000</span><br><span class="line">nstlog                   = 5000</span><br><span class="line">nstxout-compressed       = 2000</span><br><span class="line"></span><br><span class="line">continuation             = yes</span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br><span class="line"></span><br><span class="line">pcoupl                   = Parrinello-Rahman </span><br><span class="line">tau_p                    = 4.0</span><br><span class="line">compressibility          = 4.46e-5</span><br><span class="line">ref_p                    = 1.0 </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi grompp -f mdp/prd.mdp -o prd.tpr -pp prd.top -po prd.mdp -c eql2.gro</span><br><span class="line">$ gmx_mpi mdrun -s prd.tpr -o prd.trr -x prd.xtc -c prd.gro -e prd.edr -g prd.log</span><br></pre></td></tr></table></figure></li></ul><h2 id="轨迹分析">轨迹分析</h2><p>可以使用vmd进行可视化：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vmd prd.gro prd.xtc</span><br></pre></td></tr></table></figure><p>上面可视化轨迹并不推荐，而是通过<code>gmx_mpi trjconv</code> 处理之后，通过vmd可视化。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi trjconv -f prd.xtc -s prd.tpr -pbc mol -o prd-mol.xtc</span><br></pre></td></tr></table></figure><p>图片渲染</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./tachyon_LINUXAMD64 0.dat -aasamples 100 -mediumshade -trans_vmd -res 5120 3840 -format BMP -o 0.bmp</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
