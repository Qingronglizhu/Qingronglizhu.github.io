<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2024/04/20/%E7%AC%AC%E5%9B%9B%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/20/%E7%AC%AC%E5%9B%9B%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="GROMACS-产生SO4的GROMACS的拓扑和gro文件：力常数全基于Hessian计算得到">[GROMACS]<strong>产生SO4的GROMACS的拓扑和gro文件：力常数全基于Hessian计算得到</strong></h2><h3 id="1-Gaussian对SO4做优化和振动分析">1 Gaussian对SO4做优化和振动分析</h3><p>首先用Gaussian对SO4做优化+振动分析并保留.fch/fchk文件，里面包含了要用的笛卡尔Hessian矩阵和优化后的坐标信息。然后把优化后的结构保存成mol2文件。注意此文件里的键连关系必须和实际要产生的力场项对应，在GaussView里可以肉眼检查，不符的话就调整。只要连接关系正确就行，而成键方式随意。本例中，使用对于无机刚性体系都可以得到拓扑文件。</p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">%chk=SO4.chk</span><br><span class="line">#p tpssh/def2tzvp opt freq</span><br><span class="line"></span><br><span class="line">Molecule Name</span><br><span class="line"></span><br><span class="line">-2 1</span><br><span class="line"> S                  0.80990000   12.41490000    8.99380000</span><br><span class="line"> O                  1.83470000   12.61620000   10.04100000</span><br><span class="line"> O                 -0.47150000   12.99740000    9.43000000</span><br><span class="line"> O                  1.25950000   13.15250000    7.77620000</span><br><span class="line"> O                  0.65810000   11.01280000    8.68580000</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>将<code>.mol2</code> 文件载入Sobtop，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">2 //产生gro文件</span><br><span class="line">[回车] //默认的gro文件产生路径</span><br><span class="line">-1 //设置产生力常数的方法</span><br><span class="line">4 //DRIH方法</span><br><span class="line">1 //产生GROMACS拓扑文件</span><br><span class="line">2 //指认GAFF原子类型，没法指认的自动用UFF原子类型</span><br><span class="line">2 //所有力常数都通过DRIH方法得到</span><br><span class="line">SO4.fchk　//Gaussian的freq任务得到的，用于给Sobtop提供Hessian矩阵。这一步用ORCA的freq任务产生的.hess文件、xtb的--ohess任务产生的名为hessian的文件、CP2K振动分析的输出文件亦可</span><br><span class="line">[回车] //用默认的top文件产生路径</span><br><span class="line">[回车] //用默认的itp文件产生路径</span><br></pre></td></tr></table></figure><p>当前目录下已经有了SO4.itp、SO4.top和SO4.gro。此例原子类型都是GAFF的，平衡键长来自SO4.fchk，力常数使用DRIH方法基于Hessian产生。SO4.itp里包含的是SO4分子的拓扑信息，包括定义此分子的[ moleculetype ]字段，以及定义其中涉及到的原子类型的[ atomtypes ]字段。由[ moleculetype ]下面的信息可见Sobtop自动设的分子名就是结构文件去除后缀后的名字。SO4.top是主top文件，包含了GAFF/AMBER力场下模拟适用的[ defaults ]字段、整个体系名[ system ]字段，以及分子数目字段[ molecules ]。</p><p>等价性RESP电荷计算，启动Multiwfn，然后载入<code>.fchk</code> 文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7  //计算原子电荷</span><br><span class="line">18  //计算RESP电荷</span><br><span class="line">5  //等价性约束设置</span><br><span class="line">11  //根据点群自动判断等价性</span><br><span class="line">a  //根据整个体系的结构判断点群</span><br><span class="line">y  //当前屏幕上显示的点群是，列出的原子等价性没错，所以这里输入y确认。然后当前目录下有了等价性设置文件eqvcons_PG.txt</span><br><span class="line">q  //返回</span><br><span class="line">1  //从文本文件里读取等价性设置</span><br><span class="line">eqvcons_PG.txt  //刚才产生的文件</span><br><span class="line">2  //开始一步式RESP电荷拟合</span><br><span class="line">[回车]  //程序提示缺半径，按回车表示用推荐的半径</span><br><span class="line">Multiwfn算RESP电荷效率很高，RESP电荷很快就产生了，从屏幕上给出的结果看确实原子电荷合理，而且满足等价性。按y把产生的原子电荷导出为当前目录下的.chg。</span><br></pre></td></tr></table></figure><p>得到<code>SO4.chg</code> 文件，手动修改上一步得到的<code>SO4.itp</code> 文件。</p><h3 id="2-Packmol建模">2 Packmol建模</h3><p><strong>注意事项：</strong> 由于建模的<code>.pbd</code> 文件会用于后续的GROMACS模拟，因此格式非常重要。（常常需要手动修改原子的名称，确保其不重复）</p><p>其中，Cu-MET.pdb：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">HETATM    1 Cu1  MOL A   1       6.196   3.873   2.351                      Cu</span><br><span class="line">HETATM    2 N2   MOL A   1       3.186   5.020   2.737                       N</span><br><span class="line">HETATM    3 H3   MOL A   1       2.289   5.358   3.053                       H</span><br><span class="line">HETATM    4 N4   MOL A   1       2.107   2.991   2.520                       N</span><br><span class="line">HETATM    5 N5   MOL A   1       5.424   5.638   2.437                       N</span><br><span class="line">HETATM    6 H6   MOL A   1       6.029   6.426   2.230                       H</span><br><span class="line">HETATM    7 N7   MOL A   1       3.747   7.242   2.688                       N</span><br><span class="line">HETATM    8 H8   MOL A   1       4.405   8.006   2.672                       H</span><br><span class="line">HETATM    9 H9   MOL A   1       2.773   7.490   2.604                       H</span><br><span class="line">HETATM   10 C10  MOL A   1       3.271   3.653   2.523                       C</span><br><span class="line">HETATM   11 C11  MOL A   1       4.174   5.972   2.603                       C</span><br><span class="line">HETATM   12 C12  MOL A   1       2.114   1.523   2.458                       C</span><br><span class="line">HETATM   13 H13  MOL A   1       2.352   1.170   1.451                       H</span><br><span class="line">HETATM   14 H14  MOL A   1       1.125   1.164   2.728                       H</span><br><span class="line">HETATM   15 H15  MOL A   1       2.827   1.118   3.179                       H</span><br><span class="line">HETATM   16 C16  MOL A   1       0.807   3.684   2.522                       C</span><br><span class="line">HETATM   17 H17  MOL A   1       0.565   4.082   3.513                       H</span><br><span class="line">HETATM   18 H18  MOL A   1       0.040   2.962   2.255                       H</span><br><span class="line">HETATM   19 H19  MOL A   1       0.788   4.477   1.772                       H</span><br><span class="line">HETATM   20 O20  MOL A   1       7.172   2.159   1.707                       O</span><br><span class="line">HETATM   21 H21  MOL A   1       7.011   1.625   0.916                       H</span><br><span class="line">HETATM   22 H22  MOL A   1       7.384   1.567   2.447                       H</span><br><span class="line">HETATM   23 N23  MOL A   1       4.444   3.078   2.364                       N</span><br><span class="line">HETATM   24 H24  MOL A   1       4.373   2.098   2.120                       H</span><br><span class="line">HETATM   25 O25  MOL A   1       6.962   2.784   4.378                       O</span><br><span class="line">HETATM   26 H26  MOL A   1       7.752   2.972   4.906                       H</span><br><span class="line">HETATM   27 H27  MOL A   1       6.297   2.493   5.018                       H</span><br><span class="line">HETATM   28 O28  MOL A   1       8.054   4.709   2.129                       O</span><br><span class="line">HETATM   29 H29  MOL A   1       8.730   4.173   1.688                       H</span><br><span class="line">HETATM   30 H30  MOL A   1       8.503   5.278   2.770                       H</span><br><span class="line">END</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>SO4.pdb:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HETATM    1  S1   MOL A   1       0.000   0.000  -0.000  1.00  0.00           S</span><br><span class="line">HETATM    2  O2   MOL A   1       1.140   0.968  -0.153  1.00  0.00           O</span><br><span class="line">HETATM    3  O3   MOL A   1      -1.304   0.740  -0.110  1.00  0.00           O</span><br><span class="line">HETATM    4  O4   MOL A   1       0.078  -1.041  -1.082  1.00  0.00           O</span><br><span class="line">HETATM    5  O5   MOL A   1       0.086  -0.667   1.345  1.00  0.00           O</span><br><span class="line">END</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>将上面文件合并成一个pdb文件，<code>mix_in.pdb</code>使用GaussView观察结构的合理性(注意合并的格式需要保持一致)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">HETATM    1 Cu1  MOL A   1       6.196   3.873   2.351                      Cu</span><br><span class="line">HETATM    2 N2   MOL A   1       3.186   5.020   2.737                       N</span><br><span class="line">HETATM    3 H3   MOL A   1       2.289   5.358   3.053                       H</span><br><span class="line">HETATM    4 N4   MOL A   1       2.107   2.991   2.520                       N</span><br><span class="line">HETATM    5 N5   MOL A   1       5.424   5.638   2.437                       N</span><br><span class="line">HETATM    6 H6   MOL A   1       6.029   6.426   2.230                       H</span><br><span class="line">HETATM    7 N7   MOL A   1       3.747   7.242   2.688                       N</span><br><span class="line">HETATM    8 H8   MOL A   1       4.405   8.006   2.672                       H</span><br><span class="line">HETATM    9 H9   MOL A   1       2.773   7.490   2.604                       H</span><br><span class="line">HETATM   10 C10  MOL A   1       3.271   3.653   2.523                       C</span><br><span class="line">HETATM   11 C11  MOL A   1       4.174   5.972   2.603                       C</span><br><span class="line">HETATM   12 C12  MOL A   1       2.114   1.523   2.458                       C</span><br><span class="line">HETATM   13 H13  MOL A   1       2.352   1.170   1.451                       H</span><br><span class="line">HETATM   14 H14  MOL A   1       1.125   1.164   2.728                       H</span><br><span class="line">HETATM   15 H15  MOL A   1       2.827   1.118   3.179                       H</span><br><span class="line">HETATM   16 C16  MOL A   1       0.807   3.684   2.522                       C</span><br><span class="line">HETATM   17 H17  MOL A   1       0.565   4.082   3.513                       H</span><br><span class="line">HETATM   18 H18  MOL A   1       0.040   2.962   2.255                       H</span><br><span class="line">HETATM   19 H19  MOL A   1       0.788   4.477   1.772                       H</span><br><span class="line">HETATM   20 O20  MOL A   1       7.172   2.159   1.707                       O</span><br><span class="line">HETATM   21 H21  MOL A   1       7.011   1.625   0.916                       H</span><br><span class="line">HETATM   22 H22  MOL A   1       7.384   1.567   2.447                       H</span><br><span class="line">HETATM   23 N23  MOL A   1       4.444   3.078   2.364                       N</span><br><span class="line">HETATM   24 H24  MOL A   1       4.373   2.098   2.120                       H</span><br><span class="line">HETATM   25 O25  MOL A   1       6.962   2.784   4.378                       O</span><br><span class="line">HETATM   26 H26  MOL A   1       7.752   2.972   4.906                       H</span><br><span class="line">HETATM   27 H27  MOL A   1       6.297   2.493   5.018                       H</span><br><span class="line">HETATM   28 O28  MOL A   1       8.054   4.709   2.129                       O</span><br><span class="line">HETATM   29 H29  MOL A   1       8.730   4.173   1.688                       H</span><br><span class="line">HETATM   30 H30  MOL A   1       8.503   5.278   2.770                       H</span><br><span class="line">HETATM   1  S1   MOL A   1       0.000   0.000  -0.000                       S</span><br><span class="line">HETATM   2  O2   MOL A   1       1.140   0.968  -0.153                       O</span><br><span class="line">HETATM   3  O3   MOL A   1      -1.304   0.740  -0.110                       O</span><br><span class="line">HETATM   4  O4   MOL A   1       0.078  -1.041  -1.082                       O</span><br><span class="line">HETATM   5  O5   MOL A   1       0.086  -0.667   1.345                       O</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>然后构建Packmol输入文件<code>mix.inp</code>：(注意合并的格式需要保持一致)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tolerance 2.0</span><br><span class="line">add_box_sides 1.2</span><br><span class="line">output mix_out.pdb</span><br><span class="line">structure mix_in.pdb</span><br><span class="line">  number 1000</span><br><span class="line">  inside cube 0. 0. 0. 100.</span><br><span class="line">end structure</span><br></pre></td></tr></table></figure><p>建模需要根据实际情况设置分子的个数，之后使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi editconf -f mix_out.pdb -o mix_out.gro</span><br></pre></td></tr></table></figure><p>将<code>.pdb</code>转化为<code>.gro</code> 文件。使用VScode进行编辑的时候需要用到多行匹配：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(.*?)(S1).*(?:.|\n).*(?:.|\n).*(?:.|\n).*(?:.|\n).*</span><br></pre></td></tr></table></figure><p>删除空行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^\s*(?=\r?$)\n</span><br></pre></td></tr></table></figure><p>建模使用的GROMACS语句，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi solvate -cp conf.gro -o conf.gro -cs tip4p -p topol.top -box 2.3 2.3 2.3</span><br></pre></td></tr></table></figure><p>能量最小化：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi grompp -f mdp/min.mdp -o min.tpr -pp min.top -po min.mdp</span><br><span class="line">$ gmx_mpi mdrun -s min.tpr -o min.trr -x min.xtc -c min.gro -e min.edr -g min.log</span><br><span class="line"></span><br><span class="line">$ gmx_mpi grompp -f mdp/min2.mdp -o min2.tpr -pp min2.top -po min2.mdp -c min.gro</span><br><span class="line">$ gmx_mpi mdrun -s min2.tpr -o min2.trr -x min2.xtc -c min2.gro -e min2.edr -g min2.log</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第二篇博客</title>
      <link href="/2024/04/15/%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/15/%E7%AC%AC%E4%BA%8C%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="Nanomotors">[Nanomotors]</h2><h3 id="期刊：Journal-of-the-American-Chemical-Society">期刊：Journal of the American Chemical Society</h3><h3 id="Rotary-F-sub-0-sub-F-sub-1-sub-ATP-Synthase-Driven-Flasklike-Pentosan-Colloidal-Motors-with-ATP-Synthesis-and-Storage">Rotary F<sub>0</sub>F<sub>1</sub>-ATP Synthase-Driven Flasklike Pentosan Colloidal Motors with ATP Synthesis and Storage</h3><p>摘要：文章介绍了一种叶绿体衍生的“F<sub>o</sub>F<sub>1</sub>-ATPase motor-propelled flasklike pentosan</p><p>colloidal motor (FPCM)” 的分层组装，其具有合成、存储和触发生物能量货币ATP的能力。通过结合软模板水热聚合和真空注入含有F<sub>o</sub>F<sub>1</sub>-ATPase的脂质体来制备。注入酸性缓冲溶液，质子驱动F<sub>o</sub>F<sub>1</sub>-ATPase的旋转，从而促进FPCMs的运动，并伴随内部ATP的合成和存储。</p><span id="more"></span><h4 id="示意图：">示意图：</h4><p><img src="JACS1.png" alt></p><p><strong>实验方法：</strong></p><p><strong>PREPARATION OF THE RBMPS.</strong></p><p>​Chloroplasts were isolated from <strong>fresh spinach</strong> using a method similar to that reported previously. Briefly, 500 g of fresh spinach were grated with quartz sand in a mortar and added to a <strong>chloroplast buffer</strong> containing 0.4 M sucrose, 0.01 M KCl, 0.01 M Na<sub>2</sub>HPO<sub>4</sub>, 0.03 M KH<sub>2</sub>PO<sub>4</sub>, and 2 mM vitamin C in 40 ml. The homogenate was collected in a centrifuge tube and filtered through eight layers of cotton gauze. The supernatant was collected after centrifuging the filtrate at <strong>3000 g for 2 min</strong>. Gradient density centrifugation was used to separate intact chloroplasts during the second centrifuge filtrate. The intact chloroplasts were washed three times with 10 ml of buffer, and a green suspension was obtained. The recycled chloroplast pellet was suspended in a solution containing 10 mM HEPES-KOH (pH=7.8) and 5 mM MgCl<sub>2</sub> and allowed to stand for 15 min in the dark on ice to lyse the chloroplasts. Thylakoids were sedimented by centrifugation at <strong>3000 g for 3 min</strong> and resuspended in a solution containing 50 mM HEPES-KOH (pH 7.5), 100 mM sorbitol, and 10 mM MgCl<sub>2</sub>. The stacked thylakoids were homogenized in a glass homogenizer for 5 min in an ice bath. The resulting mixed solution was extruded through porous <strong>800 nm</strong> polycarbonate membrane filters to remove larger thylakoid fragments. Then thylakoid fragments were further mechanically extruded through a porous polycarbonate membrane with a diameter of <strong>100 nm</strong> for fabrication of thylakoid vesicles. The recovered thylakoid vesicles were then uniformly mixed with phospholipid vesicles and extruded through a 100 nm polycarbonate membrane 21 times to obtain RBMPs. Finally, the clear light green solution was stored in the dark at 4 °C.</p><p><strong>PREPARATION OF THE FPCMS.</strong></p><p>The flasklike colloidal motors were prepared using a previously established method. In brief, a clear solution was formed by slowly stirring 0.0365 g of sodium oleate (SO) and 0.0435 g of Poly (ethylene glycol)-block-poly (propylene glycol)-block-poly-(ethylene glycol) (EO20-PO70-EO20, P123) in 20 mL of deionized water. Next, 40 mL of a solution containing 3 g of <strong>ribose</strong> was added and the resulting mixture was stirred for 30 minutes before being transferred to a 100 mL autoclave and placed in an oven at 160 °C for 10 hours. The resulting products were collected, washed by centrifugation, and then dried and stored as flask-like pentosan colloidal particles. To prepare the FPCMs, 0.5 mg of the particles were added to a solution containing 9 mg of RBMPs in 1 mL of ADP buffer solution. This solution was placed in a vacuum chamber at a pressure of -0.1 bar for 30 minutes and then ultrasonicated for 1 hour at 0 °C. The resulting motors were washed three times with ADP buffer solution by centrifugation and finally stored in the same solution at 4 °C.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第三篇博客</title>
      <link href="/2024/04/15/%E7%AC%AC%E4%B8%89%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/15/%E7%AC%AC%E4%B8%89%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="GROMACS-使用Sobtop创建Cu-MET的拓扑文件-学习记录（二）">[GROMACS]使用Sobtop创建Cu-MET的拓扑文件 - 学习记录（二）</h2><h3 id="1使用Gaussian做优化和振动分析">1使用Gaussian做优化和振动分析</h3><p>从<a href="https://www.ccdc.cam.ac.uk/">Advancing Structural Science | CCDC (cam.ac.uk)</a> 获得Cu-MET分子结构文件<code>.mol2</code> 。去掉多余的阴离子，并写入体系的电荷，和<strong>自旋多重度</strong>=2S + 1,（对于铜离子，我是这样理解的，其最外层电子结构为3d9， 可能自旋多重度为2 ，4， 6 …）。对于过度金属配合物，选择TPSSh/def2-TZVP级别进行计算。输入文件：</p><span id="more"></span><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">%chk=Cu-MET.chk</span><br><span class="line">#p tpssh/def2tzvp opt freq</span><br><span class="line"></span><br><span class="line">Molecule Name</span><br><span class="line"></span><br><span class="line">2 2</span><br><span class="line"> Cu                 0.68340000   11.65550000    4.11380000</span><br><span class="line"> N                  1.33280000    8.49740000    4.66170000</span><br><span class="line"> H                  1.55210000    7.67890000    4.81240000</span><br><span class="line"> N                  1.31460000    7.86950000    2.44020000</span><br><span class="line"> N                  0.90890000   10.57550000    5.67970000</span><br><span class="line"> H                  0.82250000   10.98660000    6.43030000</span><br><span class="line"> N                  1.30830000    8.68050000    6.95030000</span><br><span class="line"> H                  1.21690000    9.12340000    7.68160000</span><br><span class="line"> H                  1.48430000    7.83770000    6.97690000</span><br><span class="line"> C                  1.17630000    8.86180000    3.32770000</span><br><span class="line"> C                  1.17530000    9.30280000    5.76600000</span><br><span class="line"> C                  1.38130000    8.17970000    1.00880000</span><br><span class="line"> H                  0.50800000    8.08810000    0.62020000</span><br><span class="line"> H                  1.98860000    7.57420000    0.57790000</span><br><span class="line"> H                  1.69030000    9.08230000    0.89120000</span><br><span class="line"> C                  1.34520000    6.46410000    2.78100000</span><br><span class="line"> H                  2.19410000    6.24920000    3.17330000</span><br><span class="line"> H                  1.21660000    5.94090000    1.98720000</span><br><span class="line"> H                  0.64440000    6.27350000    3.40850000</span><br><span class="line"> O                 -0.25100000   12.62370000    2.64970000</span><br><span class="line"> H                 -0.88640000   12.12100000    2.25180000</span><br><span class="line"> H                  0.29530000   12.80310000    1.95320000</span><br><span class="line"> N                  0.91290000   10.09890000    3.00980000</span><br><span class="line"> H                  0.82810000   10.24100000    2.16550000</span><br><span class="line"> O                  2.91340000   12.56390000    3.55830000</span><br><span class="line"> H                  3.00980000   13.33380000    4.02780000</span><br><span class="line"> H                  3.45680000   11.87430000    3.25050000</span><br><span class="line"> O                  0.51290000   13.25530000    5.25800000</span><br><span class="line"> H                  0.80900000   14.03840000    4.85740000</span><br><span class="line"> H                  1.05740000   13.24220000    6.00580000</span><br><span class="line"> </span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>之后，使用formchk转化文件格式。使用GaussView打开<code>.fchk</code> 文件，确定连接情况（只看连接），然后保存文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$formchk Cu-MET.chk</span><br></pre></td></tr></table></figure><h3 id="2-计算RESP电荷">2 计算RESP电荷</h3><p>标准RESP电荷计算：<code>.fchk</code> 文件载入Multiwfn，依次输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">7  //布居分析与原子电荷计算</span><br><span class="line">18  //RESP模块</span><br><span class="line">1  //计算标准RESP电荷</span><br></pre></td></tr></table></figure><p>对于对称性高的的配合物，应当设置等价性：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7  //计算原子电荷</span><br><span class="line">18  //计算RESP电荷</span><br><span class="line">5  //等价性约束设置</span><br><span class="line">11  //根据点群自动判断等价性</span><br><span class="line">a  //根据整个体系的结构判断点群</span><br><span class="line">y  //当前屏幕上显示的点群确实是xxx，列出的原子等价性没错，所以这里输入y确认。然后当前目录下有了等价性设置文件eqvcons_PG.txt</span><br><span class="line">q  //返回</span><br><span class="line">1  //从文本文件里读取等价性设置</span><br><span class="line">eqvcons_PG.txt  //刚才产生的文件</span><br><span class="line">2  //开始一步式RESP电荷拟合</span><br><span class="line">[回车]  //程序提示,缺半径，按回车表示用推荐的半径</span><br><span class="line">Multiwfn算RESP电荷效率很高，RESP电荷很快就产生了，从屏幕上给出的结果看确实原子电荷合理，而且满足等价性。按y把产生的原子电荷导出为当前目录下的xxx.chg。</span><br></pre></td></tr></table></figure><h3 id="3-用Sobtop产生拓扑文件">3 用Sobtop产生拓扑文件</h3><p>将<code>Cu-MET.mol2</code> 载入Sobtop，然后输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">7  //指定原子电荷</span><br><span class="line">10  //从Multiwfn的chg文件中读取原子电荷</span><br><span class="line">Cu-MET.chg</span><br><span class="line">0  //返回</span><br><span class="line">2  //产生GROMACS的.gro文件</span><br><span class="line">[回车]  //此时当前目录下产生了Cu-MET.gro</span><br><span class="line">1  //产生GROMACS的拓扑文件</span><br><span class="line">2  //优先用GAFF原子类型，缺的自动用UFF力场的。原子类型决定了拓扑文件里的LJ参数</span><br><span class="line">2  //所有成键相关参数基于振动分析产生的fchk文件里的Hessian矩阵生成</span><br><span class="line">Cu-MET.fchk  //如果此文件和Cu-MET.mol2在相同目录下，此处直接按回车可以快捷载入</span><br><span class="line">[回车]  //在当前目录下产生Cu-MET.top</span><br><span class="line">[回车]  //在当前目录下产生Cu-MET.itp</span><br></pre></td></tr></table></figure><p><strong>注意事项：</strong> 我在载入<code>.mol2</code> 文件的时候出现了，程序闪退的现象。然后使用Multiwfn将Gaussian的<code>.fchk</code> 文件转换为<code>.pdb</code> 文件，之后使用GaussView将<code>.pdb</code> 转化为<code>.mol2</code> ，再次载入Sobtop，就不会出现闪退了。但是，之后载入<code>.chg</code> 文件 出现闪退。我的解决方案是，不载入<code>.chg</code> 文件，将生成的<code>.itp</code> 文件，手动修改电荷。</p><h3 id="4-测试拓扑文件的合理性">4 测试拓扑文件的合理性</h3><p>根据<a href="https://manual.gromacs.org/current/user-guide/mdp-options.html">Molecular dynamics parameters (.mdp options) - GROMACS 2024.1 documentation</a> 设置参数，理解各个选项的含义。NVT模拟，在<code>.gro</code> 文件设置盒子的大小，方向。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.001     ; 2 fs</span><br><span class="line">nsteps                   = 100000     ;  ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 500</span><br><span class="line">nstlog                   = 500</span><br><span class="line">nstxout-compressed       = 500</span><br><span class="line"></span><br><span class="line">gen-vel                  = yes</span><br><span class="line">gen-temp                 = 298.15</span><br><span class="line"></span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br></pre></td></tr></table></figure><p>计算方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi grompp -f md.mdp -c Cu-MET.gro -p Cu-MET.top -o md.tpr</span><br><span class="line">$gmx_mpi mdrun -v -deffnm md</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>第一篇博客</title>
      <link href="/2024/04/15/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/04/15/%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h2 id="GROMACS-Water-学习记录（一）">[GROMACS] Water - 学习记录（一）</h2><span id="more"></span><h3 id="概述">概述</h3><p>GROMACS模拟需要三个必须的文件：</p><ul><li><p>结构文件（.gro/.pdb） - 包含每个原子的笛卡尔坐标。</p></li><li><p>拓扑文件（.top） - 包含键相互作用，非键相互作用。</p></li><li><p>输入文件（.mdp） - 包含如何运行这个系统的参数。</p><h4 id="拓扑文件">拓扑文件</h4><p>拓扑文件通过使用 <code>#include</code>  来使用力场参数。创建一个<code>topol.top</code> 文件，如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;oplsaa.ff/forcefield.itp&quot;</span><br><span class="line">#include &quot;oplsaa.ff/tip4pew.itp&quot;</span><br><span class="line"></span><br><span class="line">[ System ]</span><br><span class="line">TIP4PEW</span><br><span class="line"></span><br><span class="line">[ Molecules ]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>其中，使用OPLS-AA力场，水分子使用TIP4PEW模型。<code>[System]</code> 字段定义的是系统的名字，可以随便设置。 <code>[Molecules]</code> 字段 定于分子的<strong>名字和个数</strong>。</p><h4 id="结构文件">结构文件</h4><p>TIP4PEW结构文件，在GROMACS中已经提供。可以在<code>$GMXDATA/top</code> 中找到。<code>tip4p.gro</code> 截取部分如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">216 TIP4P Water Molecules Equilibrated for 20 ps at 300 K </span><br><span class="line">  864</span><br><span class="line">    1SOL     OW    1   1.736   0.839   0.257 -0.0525 -0.0128  0.1333</span><br><span class="line">    1SOL    HW1    2   1.777   0.781   0.322  0.3406  0.5030  0.3534</span><br><span class="line">    1SOL    HW2    3   1.643   0.831   0.274  0.0528  0.2742  0.9186</span><br></pre></td></tr></table></figure><p>其中，第一行是注释行，无关紧要。第二行是分子个数。（<strong>原子类型需要保证不一致</strong>）</p><p>之后，溶剂化体系（<strong>GROMACS我使用的是mpi的并行运算</strong>）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi solvate -cs tip4p -o conf.gro -box 2.3 2.3 2.3 -p topol.top</span><br></pre></td></tr></table></figure><p>使用2.3 nm的盒子中，填充水分子。</p><h4 id="输入文件">输入文件</h4><p>模拟通常包括3个部分：能量最小化 - 温度和压力平衡 - 模拟生产。</p><h5 id="能量最小化">能量最小化</h5><p>创建mdp文件夹，其中包含运行的输入文件，目录结构如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mdp/</span><br><span class="line">- min.mdp</span><br><span class="line">- min2.mdp</span><br><span class="line">- eql.mdp</span><br><span class="line">- eql2.mdp</span><br><span class="line">- prd.mdp</span><br></pre></td></tr></table></figure><p>其中，min.mdp代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">define                   = -DFLEXIBLE</span><br><span class="line">integrator               = steep</span><br><span class="line">nsteps                   = 100000</span><br><span class="line"></span><br><span class="line">nstenergy                = 500</span><br><span class="line">nstlog                   = 500</span><br><span class="line">nstxout-compressed       = 1000</span><br><span class="line"></span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br></pre></td></tr></table></figure><p>在mdp文件夹同一位置运行如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi grompp -f mdp/min.mdp -o min.tpr -pp min.top -po min.mdp</span><br><span class="line">$ gmx_mpi mdrun -s min.tpr -o min.trr -x min.xtc -c min.gro -e min.edr -g min.log</span><br><span class="line"></span><br><span class="line">$ gmx_mpi grompp -f mdp/min2.mdp -o min2.tpr -pp min2.top -po min2.mdp -c min.gro</span><br><span class="line">$ gmx_mpi mdrun -s min2.tpr -o min2.trr -x min2.xtc -c min2.gro -e min2.edr -g min2.log</span><br></pre></td></tr></table></figure><p>其中，<code>-f</code> 指向输入文件，如果没有<code>-c</code> 和<code>-p</code> 标志，意味着GROMACS使用默认的结构文件<code>conf.gro</code>  和拓扑文件<code>topol.top</code> ，因此这个两个文件也必须和mdp文件夹在同一目录。</p><p>注意事项：在模拟过程中，可能出现<code>Warning</code> 警告，如何是和L-BFGS的效率相关，可以使用<code>-maxwarn 1</code> 忽略掉，如果是其他的警告，需要仔细查看。</p><p>可以使用GROMACS输出相关的能量（<strong>代码运行之后，你需要选择输出的能量文件</strong>）文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi energy -f min.edr -o min-energy.xvg</span><br></pre></td></tr></table></figure><h5 id="温度和压力平衡">温度和压力平衡</h5><p>这一步需要进行温度和压力平衡，其中温度平恒eql.mdp文件如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.002     ; 2 fs</span><br><span class="line">nsteps                   = 500000     ; 1 ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 200</span><br><span class="line">nstlog                   = 2000</span><br><span class="line">nstxout-compressed       = 10000</span><br><span class="line"></span><br><span class="line">gen-vel                  = yes</span><br><span class="line">gen-temp                 = 298.15</span><br><span class="line"></span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br></pre></td></tr></table></figure><p>运行过程如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$gmx_mpi grompp -f mdp/eql.mdp -o eql.tpr -pp eql.top -po eql.mdp -c min2.gro</span><br><span class="line">$gmx_mpi mdrun -s eql.tpr -o eql.trr -x eql.xtc -c eql.gro -e eql.edr -g eql.log</span><br><span class="line"></span><br><span class="line">$gmx_mpi energy -f eql.edr -o eql-temp.xvg</span><br></pre></td></tr></table></figure><p>压力平衡文件，eql2.mdp文件如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.002     ; 2 fs</span><br><span class="line">nsteps                   = 1000000    ; 1.0 ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 200</span><br><span class="line">nstlog                   = 2000</span><br><span class="line">nstxout-compressed       = 10000</span><br><span class="line"></span><br><span class="line">continuation             = yes</span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br><span class="line"></span><br><span class="line">pcoupl                   = Parrinello-Rahman </span><br><span class="line">tau_p                    = 4.0</span><br><span class="line">compressibility          = 4.46e-5</span><br><span class="line">ref_p                    = 1.0 </span><br></pre></td></tr></table></figure><p>运行过程如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi grompp -f mdp/eql2.mdp -o eql2.tpr -pp eql2.top -po eql2.mdp -c eql.gro</span><br><span class="line">$ gmx_mpi mdrun -s eql2.tpr -o eql2.trr -x eql2.xtc -c eql2.gro -e eql2.edr -g eql2.log</span><br></pre></td></tr></table></figure><h5 id="模拟生产">模拟生产</h5><p>模拟生产prd.mdp文件如下:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">integrator               = md        </span><br><span class="line">dt                       = 0.002     ; 2 fs</span><br><span class="line">nsteps                   = 5000000   ; 10.0 ns</span><br><span class="line"></span><br><span class="line">nstenergy                = 5000</span><br><span class="line">nstlog                   = 5000</span><br><span class="line">nstxout-compressed       = 2000</span><br><span class="line"></span><br><span class="line">continuation             = yes</span><br><span class="line">constraint-algorithm     = lincs</span><br><span class="line">constraints              = h-bonds</span><br><span class="line"></span><br><span class="line">cutoff-scheme            = Verlet</span><br><span class="line"></span><br><span class="line">coulombtype              = PME</span><br><span class="line">rcoulomb                 = 1.0</span><br><span class="line"></span><br><span class="line">vdwtype                  = Cut-off</span><br><span class="line">rvdw                     = 1.0</span><br><span class="line">DispCorr                 = EnerPres</span><br><span class="line"></span><br><span class="line">tcoupl                   = Nose-Hoover</span><br><span class="line">tc-grps                  = System</span><br><span class="line">tau-t                    = 2.0</span><br><span class="line">ref-t                    = 298.15</span><br><span class="line">nhchainlength            = 1</span><br><span class="line"></span><br><span class="line">pcoupl                   = Parrinello-Rahman </span><br><span class="line">tau_p                    = 4.0</span><br><span class="line">compressibility          = 4.46e-5</span><br><span class="line">ref_p                    = 1.0 </span><br></pre></td></tr></table></figure></li></ul><h2 id="轨迹分析">轨迹分析</h2><p>可以使用vmd进行可视化：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vmd prd.gro prd.xtc</span><br></pre></td></tr></table></figure><p>上面可视化轨迹并不推荐，而是通过<code>gmx_mpi trjconv</code> 处理之后，通过vmd可视化。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gmx_mpi trjconv -f prd.xtc -s prd.tpr -pbc mol -o prd-mol.xtc</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
